class G{constructor(t){this.properties=t??[]}get(t){const n=this.properties.filter(r=>r.name===t).map(r=>r.value);if(n.length>1)throw new Error('Expected only one property to be named "'+t+'"');if(n.length!==0)return n[0]}getString(t){return this.getByType(t,"string")}getNumber(t){return this.getByType(t,"number")}getBoolean(t){return this.getByType(t,"boolean")}getByType(t,n){const r=this.get(t);if(r!==void 0){if(n!=="json"&&typeof r!==n)throw new Error('Expected property "'+t+'" to have type "'+n+'"');return r}}mustGetString(t){return this.mustGetByType(t,"string")}mustGetNumber(t){return this.mustGetByType(t,"number")}mustGetBoolean(t){return this.mustGetByType(t,"boolean")}mustGetByType(t,n){const r=this.get(t);if(r===void 0)throw new Error('Property "'+t+'" is missing');if(n!=="json"&&typeof r!==n)throw new Error('Expected property "'+t+'" to have type "'+n+'"');return r}getType(t){const n=this.properties.filter(r=>r.name===t).map(r=>r.type);if(n.length>1)throw new Error('Expected only one property to be named "'+t+'"');if(n.length!==0)return n[0]}}const Be="https://unpkg.com/@workadventure/scripting-api-extra@1.4.8/dist";class Jt{constructor(t){this.name=t.name,this.x=t.x,this.y=t.y,this.properties=new G(t.properties)}get isReadable(){const t=this.properties.getString("readableBy");return t?WA.player.tags.includes(t):!0}get isWritable(){const t=this.properties.getString("writableBy");return t?WA.player.tags.includes(t):!0}}function Ge(e){const t=e?"#"+e.join():"";WA.nav.openCoWebSite(Be+"/configuration.html"+t)}async function Kt(e,t){const n=await WA.room.getTiledMap(),r=new Map;return gt(n.layers,r,e,t),r}function gt(e,t,n,r){for(const o of e)if(o.type==="objectgroup"){for(const s of o.objects)if(s.type==="variable"||s.class==="variable"){if(n&&o.name!==n||r&&!r.includes(s.name))continue;t.set(s.name,new Jt(s))}}else o.type==="group"&&gt(o.layers,t,n,r)}let ve;async function re(){return ve===void 0&&(ve=Yt()),ve}async function Yt(){return Xt(await WA.room.getTiledMap())}function Xt(e){const t=new Map;return bt(e.layers,"",t),t}function bt(e,t,n){for(const r of e)r.type==="group"?bt(r.layers,t+r.name+"/",n):(r.name=t+r.name,n.set(r.name,r))}async function wt(){const e=await re(),t=[];for(const n of e.values())if(n.type==="objectgroup")for(const r of n.objects)(r.type==="area"||r.class==="area")&&t.push(r);return t}function Qt(e){let t=1/0,n=1/0,r=0,o=0;const s=e.data;if(typeof s=="string")throw new Error("Unsupported tile layer data stored as string instead of CSV");for(let i=0;i<e.height;i++)for(let a=0;a<e.width;a++)s[a+i*e.width]!==0&&(t=Math.min(t,a),o=Math.max(o,a),n=Math.min(n,i),r=Math.max(r,i));return{top:n,left:t,right:o+1,bottom:r+1}}function At(e){let t=1/0,n=1/0,r=0,o=0;for(const s of e){const i=Qt(s);i.left<t&&(t=i.left),i.top<n&&(n=i.top),i.right>o&&(o=i.right),i.bottom>r&&(r=i.bottom)}return{top:n,left:t,right:o,bottom:r}}/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */var Zt=Object.prototype.toString,Y=Array.isArray||function(t){return Zt.call(t)==="[object Array]"};function Me(e){return typeof e=="function"}function en(e){return Y(e)?"array":typeof e}function Ee(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function Je(e,t){return e!=null&&typeof e=="object"&&t in e}function tn(e,t){return e!=null&&typeof e!="object"&&e.hasOwnProperty&&e.hasOwnProperty(t)}var nn=RegExp.prototype.test;function rn(e,t){return nn.call(e,t)}var on=/\S/;function sn(e){return!rn(on,e)}var an={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};function cn(e){return String(e).replace(/[&<>"'`=\/]/g,function(n){return an[n]})}var ln=/\s*/,un=/\s+/,Ke=/\s*=/,fn=/\s*\}/,pn=/#|\^|\/|>|\{|&|=|!/;function dn(e,t){if(!e)return[];var n=!1,r=[],o=[],s=[],i=!1,a=!1,u="",d=0;function f(){if(i&&!a)for(;s.length;)delete o[s.pop()];else s=[];i=!1,a=!1}var l,g,v;function h(N){if(typeof N=="string"&&(N=N.split(un,2)),!Y(N)||N.length!==2)throw new Error("Invalid tags: "+N);l=new RegExp(Ee(N[0])+"\\s*"),g=new RegExp("\\s*"+Ee(N[1])),v=new RegExp("\\s*"+Ee("}"+N[1]))}h(t||x.tags);for(var p=new oe(e),b,y,w,P,H,j;!p.eos();){if(b=p.pos,w=p.scanUntil(l),w)for(var Se=0,Gt=w.length;Se<Gt;++Se)P=w.charAt(Se),sn(P)?(s.push(o.length),u+=P):(a=!0,n=!0,u+=" "),o.push(["text",P,b,b+1]),b+=1,P===`
`&&(f(),u="",d=0,n=!1);if(!p.scan(l))break;if(i=!0,y=p.scan(pn)||"name",p.scan(ln),y==="="?(w=p.scanUntil(Ke),p.scan(Ke),p.scanUntil(g)):y==="{"?(w=p.scanUntil(v),p.scan(fn),p.scanUntil(g),y="&"):w=p.scanUntil(g),!p.scan(g))throw new Error("Unclosed tag at "+p.pos);if(y==">"?H=[y,w,b,p.pos,u,d,n]:H=[y,w,b,p.pos],d++,o.push(H),y==="#"||y==="^")r.push(H);else if(y==="/"){if(j=r.pop(),!j)throw new Error('Unopened section "'+w+'" at '+b);if(j[1]!==w)throw new Error('Unclosed section "'+j[1]+'" at '+b)}else y==="name"||y==="{"||y==="&"?a=!0:y==="="&&h(w)}if(f(),j=r.pop(),j)throw new Error('Unclosed section "'+j[1]+'" at '+p.pos);return yn(hn(o))}function hn(e){for(var t=[],n,r,o=0,s=e.length;o<s;++o)n=e[o],n&&(n[0]==="text"&&r&&r[0]==="text"?(r[1]+=n[1],r[3]=n[3]):(t.push(n),r=n));return t}function yn(e){for(var t=[],n=t,r=[],o,s,i=0,a=e.length;i<a;++i)switch(o=e[i],o[0]){case"#":case"^":n.push(o),r.push(o),n=o[4]=[];break;case"/":s=r.pop(),s[5]=o[2],n=r.length>0?r[r.length-1][4]:t;break;default:n.push(o)}return t}function oe(e){this.string=e,this.tail=e,this.pos=0}oe.prototype.eos=function(){return this.tail===""};oe.prototype.scan=function(t){var n=this.tail.match(t);if(!n||n.index!==0)return"";var r=n[0];return this.tail=this.tail.substring(r.length),this.pos+=r.length,r};oe.prototype.scanUntil=function(t){var n=this.tail.search(t),r;switch(n){case-1:r=this.tail,this.tail="";break;case 0:r="";break;default:r=this.tail.substring(0,n),this.tail=this.tail.substring(n)}return this.pos+=r.length,r};function J(e,t){this.view=e,this.cache={".":this.view},this.parent=t}J.prototype.push=function(t){return new J(t,this)};J.prototype.lookup=function(t){var n=this.cache,r;if(n.hasOwnProperty(t))r=n[t];else{for(var o=this,s,i,a,u=!1;o;){if(t.indexOf(".")>0)for(s=o.view,i=t.split("."),a=0;s!=null&&a<i.length;)a===i.length-1&&(u=Je(s,i[a])||tn(s,i[a])),s=s[i[a++]];else s=o.view[t],u=Je(o.view,t);if(u){r=s;break}o=o.parent}n[t]=r}return Me(r)&&(r=r.call(this.view)),r};function T(){this.templateCache={_cache:{},set:function(t,n){this._cache[t]=n},get:function(t){return this._cache[t]},clear:function(){this._cache={}}}}T.prototype.clearCache=function(){typeof this.templateCache<"u"&&this.templateCache.clear()};T.prototype.parse=function(t,n){var r=this.templateCache,o=t+":"+(n||x.tags).join(":"),s=typeof r<"u",i=s?r.get(o):void 0;return i==null&&(i=dn(t,n),s&&r.set(o,i)),i};T.prototype.render=function(t,n,r,o){var s=this.getConfigTags(o),i=this.parse(t,s),a=n instanceof J?n:new J(n,void 0);return this.renderTokens(i,a,r,t,o)};T.prototype.renderTokens=function(t,n,r,o,s){for(var i="",a,u,d,f=0,l=t.length;f<l;++f)d=void 0,a=t[f],u=a[0],u==="#"?d=this.renderSection(a,n,r,o,s):u==="^"?d=this.renderInverted(a,n,r,o,s):u===">"?d=this.renderPartial(a,n,r,s):u==="&"?d=this.unescapedValue(a,n):u==="name"?d=this.escapedValue(a,n,s):u==="text"&&(d=this.rawValue(a)),d!==void 0&&(i+=d);return i};T.prototype.renderSection=function(t,n,r,o,s){var i=this,a="",u=n.lookup(t[1]);function d(g){return i.render(g,n,r,s)}if(u){if(Y(u))for(var f=0,l=u.length;f<l;++f)a+=this.renderTokens(t[4],n.push(u[f]),r,o,s);else if(typeof u=="object"||typeof u=="string"||typeof u=="number")a+=this.renderTokens(t[4],n.push(u),r,o,s);else if(Me(u)){if(typeof o!="string")throw new Error("Cannot use higher-order sections without the original template");u=u.call(n.view,o.slice(t[3],t[5]),d),u!=null&&(a+=u)}else a+=this.renderTokens(t[4],n,r,o,s);return a}};T.prototype.renderInverted=function(t,n,r,o,s){var i=n.lookup(t[1]);if(!i||Y(i)&&i.length===0)return this.renderTokens(t[4],n,r,o,s)};T.prototype.indentPartial=function(t,n,r){for(var o=n.replace(/[^ \t]/g,""),s=t.split(`
`),i=0;i<s.length;i++)s[i].length&&(i>0||!r)&&(s[i]=o+s[i]);return s.join(`
`)};T.prototype.renderPartial=function(t,n,r,o){if(r){var s=this.getConfigTags(o),i=Me(r)?r(t[1]):r[t[1]];if(i!=null){var a=t[6],u=t[5],d=t[4],f=i;u==0&&d&&(f=this.indentPartial(i,d,a));var l=this.parse(f,s);return this.renderTokens(l,n,r,f,o)}}};T.prototype.unescapedValue=function(t,n){var r=n.lookup(t[1]);if(r!=null)return r};T.prototype.escapedValue=function(t,n,r){var o=this.getConfigEscape(r)||x.escape,s=n.lookup(t[1]);if(s!=null)return typeof s=="number"&&o===x.escape?String(s):o(s)};T.prototype.rawValue=function(t){return t[1]};T.prototype.getConfigTags=function(t){return Y(t)?t:t&&typeof t=="object"?t.tags:void 0};T.prototype.getConfigEscape=function(t){if(t&&typeof t=="object"&&!Y(t))return t.escape};var x={name:"mustache.js",version:"4.2.0",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,Scanner:void 0,Context:void 0,Writer:void 0,set templateCache(e){te.templateCache=e},get templateCache(){return te.templateCache}},te=new T;x.clearCache=function(){return te.clearCache()};x.parse=function(t,n){return te.parse(t,n)};x.render=function(t,n,r,o){if(typeof t!="string")throw new TypeError('Invalid template! Template should be a "string" but "'+en(t)+'" was given as the first argument for mustache#render(template, view, partials)');return te.render(t,n,r,o)};x.escape=cn;x.Scanner=oe;x.Context=J;x.Writer=T;class St{constructor(t,n){this.template=t,this.state=n,this.ast=x.parse(t)}getValue(){return this.value===void 0&&(this.value=x.render(this.template,this.state)),this.value}onChange(t){const n=[];for(const r of this.getUsedVariables().values())n.push(this.state.onVariableChange(r).subscribe(()=>{const o=x.render(this.template,this.state);o!==this.value&&(this.value=o,t(this.value))}));return{unsubscribe:()=>{for(const r of n)r.unsubscribe()}}}isPureString(){return this.ast.length===0||this.ast.length===1&&this.ast[0][0]==="text"}getUsedVariables(){const t=new Set;return this.recursiveGetUsedVariables(this.ast,t),t}recursiveGetUsedVariables(t,n){for(const r of t){const o=r[0],s=r[1],i=r[4];["name","&","#","^"].includes(o)&&n.add(s),i!==void 0&&typeof i!="string"&&this.recursiveGetUsedVariables(i,n)}}}async function mn(){var e;const t=await wt();for(const n of t){const r=(e=n.properties)!==null&&e!==void 0?e:[];for(const o of r){if(o.type==="int"||o.type==="bool"||o.type==="object"||typeof o.value!="string")continue;const s=new St(o.value,WA.state);if(s.isPureString())continue;const i=s.getValue();await Ye(n.name,o.name,i),s.onChange(async a=>{await Ye(n.name,o.name,a)})}}}async function gn(){var e;const t=await re();for(const[n,r]of t.entries())if(r.type!=="objectgroup"){const o=(e=r.properties)!==null&&e!==void 0?e:[];for(const s of o){if(s.type==="int"||s.type==="bool"||s.type==="object"||typeof s.value!="string")continue;const i=new St(s.value,WA.state);if(i.isPureString())continue;const a=i.getValue();Xe(n,s.name,a),i.onChange(u=>{Xe(n,s.name,u)})}}}async function Ye(e,t,n){console.log(e),(await WA.room.area.get(e)).setProperty(t,n)}function Xe(e,t,n){WA.room.setProperty(e,t,n),t==="visible"&&(n?WA.room.showLayer(e):WA.room.hideLayer(e))}let Re,_e=0,Fe=0;function Qe(e){if(WA.state[e.name]){let t=e.properties.mustGetString("openLayer");for(const n of t.split(`
`))WA.room.showLayer(n);t=e.properties.mustGetString("closeLayer");for(const n of t.split(`
`))WA.room.hideLayer(n)}else{let t=e.properties.mustGetString("openLayer");for(const n of t.split(`
`))WA.room.hideLayer(n);t=e.properties.mustGetString("closeLayer");for(const n of t.split(`
`))WA.room.showLayer(n)}}function bn(e){const t=e.properties.getString("openSound"),n=e.properties.getNumber("soundRadius");let r=1;if(n){const o=Et(e.properties.mustGetString("openLayer").split(`
`));if(o>n)return;r=1-o/n}t&&WA.sound.loadSound(t).play({volume:r})}function wn(e){const t=e.properties.getString("closeSound"),n=e.properties.getNumber("soundRadius");let r=1;if(n){const o=Et(e.properties.mustGetString("closeLayer").split(`
`));if(o>n)return;r=1-o/n}t&&WA.sound.loadSound(t).play({volume:r})}function vt(e){return e.map(t=>Re.get(t)).filter(t=>(t==null?void 0:t.type)==="tilelayer")}function Et(e){const t=vt(e),n=At(t),r=((n.right-n.left)/2+n.left)*32,o=((n.bottom-n.top)/2+n.top)*32;return Math.sqrt(Math.pow(_e-r,2)+Math.pow(Fe-o,2))}function An(e){WA.state.onVariableChange(e.name).subscribe(()=>{WA.state[e.name]?bn(e):wn(e),Qe(e)}),Qe(e)}function Ze(e,t,n,r){const o=e.name;let s,i,a=!1;const u=n.getString("tag");let d=!0;u&&!WA.player.tags.includes(u)&&(d=!1);const f=!!u;function l(){var y;s&&s.remove(),s=WA.ui.displayActionMessage({message:(y=n.getString("closeTriggerMessage"))!==null&&y!==void 0?y:"Press SPACE to close the door",callback:()=>{WA.state[t.name]=!1,g()}})}function g(){var y;s&&s.remove(),s=WA.ui.displayActionMessage({message:(y=n.getString("openTriggerMessage"))!==null&&y!==void 0?y:"Press SPACE to open the door",callback:()=>{WA.state[t.name]=!0,l()}})}function v(){let y;if(e.type==="tilelayer")y=At(vt(t.properties.mustGetString("closeLayer").split(`
`)));else{if(e.x===void 0||e.y===void 0||e.width===void 0||e.height===void 0)throw new Error(`Doorstep zone "${e.name}" is missing x, y, width or height`);y={top:e.y,left:e.x,right:e.x+e.width,bottom:e.y+e.height}}i=WA.room.website.create({name:"doorKeypad"+o,url:r+"/keypad.html#"+encodeURIComponent(o),position:{x:y.right*32,y:y.top*32,width:32*3,height:32*4},allowApi:!0})}function h(){i&&(WA.room.website.delete(i.name),i=void 0)}function p(){if(a=!0,n.getBoolean("autoOpen")&&d){WA.state[t.name]=!0;return}if(!WA.state[t.name]&&(f&&!d||!f)&&(n.getString("code")||n.getString("codeVariable"))){v();return}d&&(WA.state[t.name]?l():g())}function b(){a=!1,n.getBoolean("autoClose")&&(WA.state[t.name]=!1),s&&s.remove(),h()}e.type==="tilelayer"?(WA.room.onEnterLayer(o).subscribe(p),WA.room.onLeaveLayer(o).subscribe(b)):(WA.room.area.onEnter(o).subscribe(p),WA.room.area.onLeave(o).subscribe(b)),WA.state.onVariableChange(t.name).subscribe(()=>{a&&(!n.getBoolean("autoClose")&&WA.state[t.name]===!0&&l(),i&&WA.state[t.name]===!0&&h(),!n.getBoolean("autoOpen")&&WA.state[t.name]===!1&&g())})}function Sn(e){const t=e.properties.mustGetString("bellSound"),n=e.properties.getNumber("soundRadius");let r=1;if(n){const o=Math.sqrt(Math.pow(e.x-_e,2)+Math.pow(e.y-Fe,2));if(o>n)return;r=1-o/n}WA.sound.loadSound(t).play({volume:r})}function vn(e){WA.state[e.name]===void 0&&(WA.state[e.name]=0),WA.state.onVariableChange(e.name).subscribe(()=>{WA.state[e.name]&&Sn(e)})}function et(e,t,n){let r;const o=t.getString("bellPopup");if(n.type==="tilelayer"){const s=n.name;WA.room.onEnterLayer(s).subscribe(()=>{var i;o?r=WA.ui.openPopup(o,"",[{label:(i=t.getString("bellButtonText"))!==null&&i!==void 0?i:"Ring",callback:()=>{WA.state[e]=WA.state[e]+1}}]):WA.state[e]=WA.state[e]+1}),WA.room.onLeaveLayer(s).subscribe(()=>{r&&(r.close(),r=void 0)})}else{const s=n.name;WA.room.area.onEnter(s).subscribe(()=>{var i;o?r=WA.ui.openPopup(o,"",[{label:(i=t.getString("bellButtonText"))!==null&&i!==void 0?i:"Ring",callback:()=>{WA.state[e]=WA.state[e]+1}}]):WA.state[e]=WA.state[e]+1}),WA.room.area.onLeave(s).subscribe(()=>{r&&(r.close(),r=void 0)})}}async function En(e){e=e??Be;const t=await Kt();Re=await re();for(const n of t.values())n.properties.get("door")&&An(n),n.properties.get("bell")&&vn(n);for(const n of Re.values()){const r=new G(n.properties),o=r.getString("doorVariable");if(o&&n.type==="tilelayer"){const i=t.get(o);if(i===void 0)throw new Error('Cannot find variable "'+o+'" referred in the "doorVariable" property of layer "'+n.name+'"');Ze(n,i,r,e)}const s=r.getString("bellVariable");s&&n.type==="tilelayer"&&et(s,r,n)}for(const n of await wt()){const r=new G(n.properties),o=r.getString("doorVariable");if(o){const i=t.get(o);if(i===void 0)throw new Error('Cannot find variable "'+o+'" referred in the "doorVariable" property of object "'+n.name+'"');Ze(n,i,r,e)}const s=r.getString("bellVariable");s&&et(s,r,n)}WA.player.onPlayerMove(n=>{_e=n.x,Fe=n.y})}function Tn(e,t){const n=e.getString("bindVariable");if(n){const r=e.get("enterValue"),o=e.get("leaveValue"),s=e.getString("triggerMessage"),i=e.getString("tag");Pn(n,t,r,o,s,i)}}function Pn(e,t,n,r,o,s){s&&!WA.player.tags.includes(s)||(n!==void 0&&WA.room.onEnterLayer(t).subscribe(()=>{o||(WA.state[e]=n)}),r!==void 0&&WA.room.onLeaveLayer(t).subscribe(()=>{WA.state[e]=r}))}async function Wn(){const e=await re();for(const t of e.values()){const n=new G(t.properties);Tn(n,t.name)}}let tt;async function xn(e){const t=await WA.room.getTiledMap();e=e??Be,tt=await re();const n=t.layers.find(r=>r.name==="configuration");if(n){const o=new G(n.properties).getString("tag");(!o||WA.player.tags.includes(o))&&WA.ui.registerMenuCommand("Configure the room",()=>{WA.nav.openCoWebSite(e+"/configuration.html",!0)});for(const s of tt.values()){const i=new G(s.properties),a=i.getString("openConfig");a&&s.type==="tilelayer"&&Rn(a.split(","),s.name,i)}}}function Rn(e,t,n){let r;const o=n.getString("openConfigAdminTag");let s=!0;o&&!WA.player.tags.includes(o)&&(s=!1);function i(){var u;r&&r.remove(),r=WA.ui.displayActionMessage({message:(u=n.getString("openConfigTriggerMessage"))!==null&&u!==void 0?u:"Press SPACE or touch here to configure",callback:()=>Ge(e)})}function a(){WA.nav.closeCoWebSite()}WA.room.onEnterLayer(t).subscribe(()=>{const u=n.getString("openConfigTrigger");s&&(u&&u==="onaction"?i():Ge(e))}),WA.room.onLeaveLayer(t).subscribe(()=>{r&&r.remove(),a()})}function Cn(){return WA.onInit().then(()=>{En().catch(e=>console.error(e)),Wn().catch(e=>console.error(e)),xn().catch(e=>console.error(e)),gn().catch(e=>console.error(e)),mn().catch(e=>console.error(e))}).catch(e=>console.error(e))}function Tt(e,t){return function(){return e.apply(t,arguments)}}const{toString:On}=Object.prototype,{getPrototypeOf:Ue}=Object,me=(e=>t=>{const n=On.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),k=e=>(e=e.toLowerCase(),t=>me(t)===e),ge=e=>t=>typeof t===e,{isArray:X}=Array,ne=ge("undefined");function Ln(e){return e!==null&&!ne(e)&&e.constructor!==null&&!ne(e.constructor)&&R(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const Pt=k("ArrayBuffer");function kn(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&Pt(e.buffer),t}const Nn=ge("string"),R=ge("function"),Wt=ge("number"),be=e=>e!==null&&typeof e=="object",Bn=e=>e===!0||e===!1,ae=e=>{if(me(e)!=="object")return!1;const t=Ue(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},Mn=k("Date"),_n=k("File"),Fn=k("Blob"),Un=k("FileList"),jn=e=>be(e)&&R(e.pipe),Dn=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||R(e.append)&&((t=me(e))==="formdata"||t==="object"&&R(e.toString)&&e.toString()==="[object FormData]"))},In=k("URLSearchParams"),Vn=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function se(e,t,{allOwnKeys:n=!1}={}){if(e===null||typeof e>"u")return;let r,o;if(typeof e!="object"&&(e=[e]),X(e))for(r=0,o=e.length;r<o;r++)t.call(null,e[r],r,e);else{const s=n?Object.getOwnPropertyNames(e):Object.keys(e),i=s.length;let a;for(r=0;r<i;r++)a=s[r],t.call(null,e[a],a,e)}}function xt(e,t){t=t.toLowerCase();const n=Object.keys(e);let r=n.length,o;for(;r-- >0;)if(o=n[r],t===o.toLowerCase())return o;return null}const Rt=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),Ct=e=>!ne(e)&&e!==Rt;function Ce(){const{caseless:e}=Ct(this)&&this||{},t={},n=(r,o)=>{const s=e&&xt(t,o)||o;ae(t[s])&&ae(r)?t[s]=Ce(t[s],r):ae(r)?t[s]=Ce({},r):X(r)?t[s]=r.slice():t[s]=r};for(let r=0,o=arguments.length;r<o;r++)arguments[r]&&se(arguments[r],n);return t}const Hn=(e,t,n,{allOwnKeys:r}={})=>(se(t,(o,s)=>{n&&R(o)?e[s]=Tt(o,n):e[s]=o},{allOwnKeys:r}),e),qn=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),$n=(e,t,n,r)=>{e.prototype=Object.create(t.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},zn=(e,t,n,r)=>{let o,s,i;const a={};if(t=t||{},e==null)return t;do{for(o=Object.getOwnPropertyNames(e),s=o.length;s-- >0;)i=o[s],(!r||r(i,e,t))&&!a[i]&&(t[i]=e[i],a[i]=!0);e=n!==!1&&Ue(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},Gn=(e,t,n)=>{e=String(e),(n===void 0||n>e.length)&&(n=e.length),n-=t.length;const r=e.indexOf(t,n);return r!==-1&&r===n},Jn=e=>{if(!e)return null;if(X(e))return e;let t=e.length;if(!Wt(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},Kn=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&Ue(Uint8Array)),Yn=(e,t)=>{const r=(e&&e[Symbol.iterator]).call(e);let o;for(;(o=r.next())&&!o.done;){const s=o.value;t.call(e,s[0],s[1])}},Xn=(e,t)=>{let n;const r=[];for(;(n=e.exec(t))!==null;)r.push(n);return r},Qn=k("HTMLFormElement"),Zn=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,r,o){return r.toUpperCase()+o}),nt=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),er=k("RegExp"),Ot=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),r={};se(n,(o,s)=>{let i;(i=t(o,s,e))!==!1&&(r[s]=i||o)}),Object.defineProperties(e,r)},tr=e=>{Ot(e,(t,n)=>{if(R(e)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const r=e[n];if(R(r)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},nr=(e,t)=>{const n={},r=o=>{o.forEach(s=>{n[s]=!0})};return X(e)?r(e):r(String(e).split(t)),n},rr=()=>{},or=(e,t)=>(e=+e,Number.isFinite(e)?e:t),Te="abcdefghijklmnopqrstuvwxyz",rt="0123456789",Lt={DIGIT:rt,ALPHA:Te,ALPHA_DIGIT:Te+Te.toUpperCase()+rt},sr=(e=16,t=Lt.ALPHA_DIGIT)=>{let n="";const{length:r}=t;for(;e--;)n+=t[Math.random()*r|0];return n};function ir(e){return!!(e&&R(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])}const ar=e=>{const t=new Array(10),n=(r,o)=>{if(be(r)){if(t.indexOf(r)>=0)return;if(!("toJSON"in r)){t[o]=r;const s=X(r)?[]:{};return se(r,(i,a)=>{const u=n(i,o+1);!ne(u)&&(s[a]=u)}),t[o]=void 0,s}}return r};return n(e,0)},cr=k("AsyncFunction"),lr=e=>e&&(be(e)||R(e))&&R(e.then)&&R(e.catch),c={isArray:X,isArrayBuffer:Pt,isBuffer:Ln,isFormData:Dn,isArrayBufferView:kn,isString:Nn,isNumber:Wt,isBoolean:Bn,isObject:be,isPlainObject:ae,isUndefined:ne,isDate:Mn,isFile:_n,isBlob:Fn,isRegExp:er,isFunction:R,isStream:jn,isURLSearchParams:In,isTypedArray:Kn,isFileList:Un,forEach:se,merge:Ce,extend:Hn,trim:Vn,stripBOM:qn,inherits:$n,toFlatObject:zn,kindOf:me,kindOfTest:k,endsWith:Gn,toArray:Jn,forEachEntry:Yn,matchAll:Xn,isHTMLForm:Qn,hasOwnProperty:nt,hasOwnProp:nt,reduceDescriptors:Ot,freezeMethods:tr,toObjectSet:nr,toCamelCase:Zn,noop:rr,toFiniteNumber:or,findKey:xt,global:Rt,isContextDefined:Ct,ALPHABET:Lt,generateString:sr,isSpecCompliantForm:ir,toJSONObject:ar,isAsyncFn:cr,isThenable:lr};function m(e,t,n,r,o){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),r&&(this.request=r),o&&(this.response=o)}c.inherits(m,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:c.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const kt=m.prototype,Nt={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Nt[e]={value:e}});Object.defineProperties(m,Nt);Object.defineProperty(kt,"isAxiosError",{value:!0});m.from=(e,t,n,r,o,s)=>{const i=Object.create(kt);return c.toFlatObject(e,i,function(u){return u!==Error.prototype},a=>a!=="isAxiosError"),m.call(i,e.message,t,n,r,o),i.cause=e,i.name=e.name,s&&Object.assign(i,s),i};const ur=null;function Oe(e){return c.isPlainObject(e)||c.isArray(e)}function Bt(e){return c.endsWith(e,"[]")?e.slice(0,-2):e}function ot(e,t,n){return e?e.concat(t).map(function(o,s){return o=Bt(o),!n&&s?"["+o+"]":o}).join(n?".":""):t}function fr(e){return c.isArray(e)&&!e.some(Oe)}const pr=c.toFlatObject(c,{},null,function(t){return/^is[A-Z]/.test(t)});function we(e,t,n){if(!c.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,n=c.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(p,b){return!c.isUndefined(b[p])});const r=n.metaTokens,o=n.visitor||f,s=n.dots,i=n.indexes,u=(n.Blob||typeof Blob<"u"&&Blob)&&c.isSpecCompliantForm(t);if(!c.isFunction(o))throw new TypeError("visitor must be a function");function d(h){if(h===null)return"";if(c.isDate(h))return h.toISOString();if(!u&&c.isBlob(h))throw new m("Blob is not supported. Use a Buffer instead.");return c.isArrayBuffer(h)||c.isTypedArray(h)?u&&typeof Blob=="function"?new Blob([h]):Buffer.from(h):h}function f(h,p,b){let y=h;if(h&&!b&&typeof h=="object"){if(c.endsWith(p,"{}"))p=r?p:p.slice(0,-2),h=JSON.stringify(h);else if(c.isArray(h)&&fr(h)||(c.isFileList(h)||c.endsWith(p,"[]"))&&(y=c.toArray(h)))return p=Bt(p),y.forEach(function(P,H){!(c.isUndefined(P)||P===null)&&t.append(i===!0?ot([p],H,s):i===null?p:p+"[]",d(P))}),!1}return Oe(h)?!0:(t.append(ot(b,p,s),d(h)),!1)}const l=[],g=Object.assign(pr,{defaultVisitor:f,convertValue:d,isVisitable:Oe});function v(h,p){if(!c.isUndefined(h)){if(l.indexOf(h)!==-1)throw Error("Circular reference detected in "+p.join("."));l.push(h),c.forEach(h,function(y,w){(!(c.isUndefined(y)||y===null)&&o.call(t,y,c.isString(w)?w.trim():w,p,g))===!0&&v(y,p?p.concat(w):[w])}),l.pop()}}if(!c.isObject(e))throw new TypeError("data must be an object");return v(e),t}function st(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(r){return t[r]})}function je(e,t){this._pairs=[],e&&we(e,this,t)}const Mt=je.prototype;Mt.append=function(t,n){this._pairs.push([t,n])};Mt.toString=function(t){const n=t?function(r){return t.call(this,r,st)}:st;return this._pairs.map(function(o){return n(o[0])+"="+n(o[1])},"").join("&")};function dr(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function _t(e,t,n){if(!t)return e;const r=n&&n.encode||dr,o=n&&n.serialize;let s;if(o?s=o(t,n):s=c.isURLSearchParams(t)?t.toString():new je(t,n).toString(r),s){const i=e.indexOf("#");i!==-1&&(e=e.slice(0,i)),e+=(e.indexOf("?")===-1?"?":"&")+s}return e}class hr{constructor(){this.handlers=[]}use(t,n,r){return this.handlers.push({fulfilled:t,rejected:n,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){c.forEach(this.handlers,function(r){r!==null&&t(r)})}}const it=hr,Ft={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},yr=typeof URLSearchParams<"u"?URLSearchParams:je,mr=typeof FormData<"u"?FormData:null,gr=typeof Blob<"u"?Blob:null,br={isBrowser:!0,classes:{URLSearchParams:yr,FormData:mr,Blob:gr},protocols:["http","https","file","blob","url","data"]},Ut=typeof window<"u"&&typeof document<"u",wr=(e=>Ut&&["ReactNative","NativeScript","NS"].indexOf(e)<0)(typeof navigator<"u"&&navigator.product),Ar=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),Sr=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Ut,hasStandardBrowserEnv:wr,hasStandardBrowserWebWorkerEnv:Ar},Symbol.toStringTag,{value:"Module"})),L={...Sr,...br};function vr(e,t){return we(e,new L.classes.URLSearchParams,Object.assign({visitor:function(n,r,o,s){return L.isNode&&c.isBuffer(n)?(this.append(r,n.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)}},t))}function Er(e){return c.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function Tr(e){const t={},n=Object.keys(e);let r;const o=n.length;let s;for(r=0;r<o;r++)s=n[r],t[s]=e[s];return t}function jt(e){function t(n,r,o,s){let i=n[s++];if(i==="__proto__")return!0;const a=Number.isFinite(+i),u=s>=n.length;return i=!i&&c.isArray(o)?o.length:i,u?(c.hasOwnProp(o,i)?o[i]=[o[i],r]:o[i]=r,!a):((!o[i]||!c.isObject(o[i]))&&(o[i]=[]),t(n,r,o[i],s)&&c.isArray(o[i])&&(o[i]=Tr(o[i])),!a)}if(c.isFormData(e)&&c.isFunction(e.entries)){const n={};return c.forEachEntry(e,(r,o)=>{t(Er(r),o,n,0)}),n}return null}function Pr(e,t,n){if(c.isString(e))try{return(t||JSON.parse)(e),c.trim(e)}catch(r){if(r.name!=="SyntaxError")throw r}return(n||JSON.stringify)(e)}const De={transitional:Ft,adapter:["xhr","http"],transformRequest:[function(t,n){const r=n.getContentType()||"",o=r.indexOf("application/json")>-1,s=c.isObject(t);if(s&&c.isHTMLForm(t)&&(t=new FormData(t)),c.isFormData(t))return o?JSON.stringify(jt(t)):t;if(c.isArrayBuffer(t)||c.isBuffer(t)||c.isStream(t)||c.isFile(t)||c.isBlob(t))return t;if(c.isArrayBufferView(t))return t.buffer;if(c.isURLSearchParams(t))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let a;if(s){if(r.indexOf("application/x-www-form-urlencoded")>-1)return vr(t,this.formSerializer).toString();if((a=c.isFileList(t))||r.indexOf("multipart/form-data")>-1){const u=this.env&&this.env.FormData;return we(a?{"files[]":t}:t,u&&new u,this.formSerializer)}}return s||o?(n.setContentType("application/json",!1),Pr(t)):t}],transformResponse:[function(t){const n=this.transitional||De.transitional,r=n&&n.forcedJSONParsing,o=this.responseType==="json";if(t&&c.isString(t)&&(r&&!this.responseType||o)){const i=!(n&&n.silentJSONParsing)&&o;try{return JSON.parse(t)}catch(a){if(i)throw a.name==="SyntaxError"?m.from(a,m.ERR_BAD_RESPONSE,this,null,this.response):a}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:L.classes.FormData,Blob:L.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};c.forEach(["delete","get","head","post","put","patch"],e=>{De.headers[e]={}});const Ie=De,Wr=c.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),xr=e=>{const t={};let n,r,o;return e&&e.split(`
`).forEach(function(i){o=i.indexOf(":"),n=i.substring(0,o).trim().toLowerCase(),r=i.substring(o+1).trim(),!(!n||t[n]&&Wr[n])&&(n==="set-cookie"?t[n]?t[n].push(r):t[n]=[r]:t[n]=t[n]?t[n]+", "+r:r)}),t},at=Symbol("internals");function Q(e){return e&&String(e).trim().toLowerCase()}function ce(e){return e===!1||e==null?e:c.isArray(e)?e.map(ce):String(e)}function Rr(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(e);)t[r[1]]=r[2];return t}const Cr=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function Pe(e,t,n,r,o){if(c.isFunction(r))return r.call(this,t,n);if(o&&(t=n),!!c.isString(t)){if(c.isString(r))return t.indexOf(r)!==-1;if(c.isRegExp(r))return r.test(t)}}function Or(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,n,r)=>n.toUpperCase()+r)}function Lr(e,t){const n=c.toCamelCase(" "+t);["get","set","has"].forEach(r=>{Object.defineProperty(e,r+n,{value:function(o,s,i){return this[r].call(this,t,o,s,i)},configurable:!0})})}class Ae{constructor(t){t&&this.set(t)}set(t,n,r){const o=this;function s(a,u,d){const f=Q(u);if(!f)throw new Error("header name must be a non-empty string");const l=c.findKey(o,f);(!l||o[l]===void 0||d===!0||d===void 0&&o[l]!==!1)&&(o[l||u]=ce(a))}const i=(a,u)=>c.forEach(a,(d,f)=>s(d,f,u));return c.isPlainObject(t)||t instanceof this.constructor?i(t,n):c.isString(t)&&(t=t.trim())&&!Cr(t)?i(xr(t),n):t!=null&&s(n,t,r),this}get(t,n){if(t=Q(t),t){const r=c.findKey(this,t);if(r){const o=this[r];if(!n)return o;if(n===!0)return Rr(o);if(c.isFunction(n))return n.call(this,o,r);if(c.isRegExp(n))return n.exec(o);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,n){if(t=Q(t),t){const r=c.findKey(this,t);return!!(r&&this[r]!==void 0&&(!n||Pe(this,this[r],r,n)))}return!1}delete(t,n){const r=this;let o=!1;function s(i){if(i=Q(i),i){const a=c.findKey(r,i);a&&(!n||Pe(r,r[a],a,n))&&(delete r[a],o=!0)}}return c.isArray(t)?t.forEach(s):s(t),o}clear(t){const n=Object.keys(this);let r=n.length,o=!1;for(;r--;){const s=n[r];(!t||Pe(this,this[s],s,t,!0))&&(delete this[s],o=!0)}return o}normalize(t){const n=this,r={};return c.forEach(this,(o,s)=>{const i=c.findKey(r,s);if(i){n[i]=ce(o),delete n[s];return}const a=t?Or(s):String(s).trim();a!==s&&delete n[s],n[a]=ce(o),r[a]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const n=Object.create(null);return c.forEach(this,(r,o)=>{r!=null&&r!==!1&&(n[o]=t&&c.isArray(r)?r.join(", "):r)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,n])=>t+": "+n).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...n){const r=new this(t);return n.forEach(o=>r.set(o)),r}static accessor(t){const r=(this[at]=this[at]={accessors:{}}).accessors,o=this.prototype;function s(i){const a=Q(i);r[a]||(Lr(o,i),r[a]=!0)}return c.isArray(t)?t.forEach(s):s(t),this}}Ae.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);c.reduceDescriptors(Ae.prototype,({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(r){this[n]=r}}});c.freezeMethods(Ae);const M=Ae;function We(e,t){const n=this||Ie,r=t||n,o=M.from(r.headers);let s=r.data;return c.forEach(e,function(a){s=a.call(n,s,o.normalize(),t?t.status:void 0)}),o.normalize(),s}function Dt(e){return!!(e&&e.__CANCEL__)}function ie(e,t,n){m.call(this,e??"canceled",m.ERR_CANCELED,t,n),this.name="CanceledError"}c.inherits(ie,m,{__CANCEL__:!0});function kr(e,t,n){const r=n.config.validateStatus;!n.status||!r||r(n.status)?e(n):t(new m("Request failed with status code "+n.status,[m.ERR_BAD_REQUEST,m.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}const Nr=L.hasStandardBrowserEnv?{write(e,t,n,r,o,s){const i=[e+"="+encodeURIComponent(t)];c.isNumber(n)&&i.push("expires="+new Date(n).toGMTString()),c.isString(r)&&i.push("path="+r),c.isString(o)&&i.push("domain="+o),s===!0&&i.push("secure"),document.cookie=i.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Br(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function Mr(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function It(e,t){return e&&!Br(t)?Mr(e,t):t}const _r=L.hasStandardBrowserEnv?function(){const t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");let r;function o(s){let i=s;return t&&(n.setAttribute("href",i),i=n.href),n.setAttribute("href",i),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:n.pathname.charAt(0)==="/"?n.pathname:"/"+n.pathname}}return r=o(window.location.href),function(i){const a=c.isString(i)?o(i):i;return a.protocol===r.protocol&&a.host===r.host}}():function(){return function(){return!0}}();function Fr(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function Ur(e,t){e=e||10;const n=new Array(e),r=new Array(e);let o=0,s=0,i;return t=t!==void 0?t:1e3,function(u){const d=Date.now(),f=r[s];i||(i=d),n[o]=u,r[o]=d;let l=s,g=0;for(;l!==o;)g+=n[l++],l=l%e;if(o=(o+1)%e,o===s&&(s=(s+1)%e),d-i<t)return;const v=f&&d-f;return v?Math.round(g*1e3/v):void 0}}function ct(e,t){let n=0;const r=Ur(50,250);return o=>{const s=o.loaded,i=o.lengthComputable?o.total:void 0,a=s-n,u=r(a),d=s<=i;n=s;const f={loaded:s,total:i,progress:i?s/i:void 0,bytes:a,rate:u||void 0,estimated:u&&i&&d?(i-s)/u:void 0,event:o};f[t?"download":"upload"]=!0,e(f)}}const jr=typeof XMLHttpRequest<"u",Dr=jr&&function(e){return new Promise(function(n,r){let o=e.data;const s=M.from(e.headers).normalize();let{responseType:i,withXSRFToken:a}=e,u;function d(){e.cancelToken&&e.cancelToken.unsubscribe(u),e.signal&&e.signal.removeEventListener("abort",u)}let f;if(c.isFormData(o)){if(L.hasStandardBrowserEnv||L.hasStandardBrowserWebWorkerEnv)s.setContentType(!1);else if((f=s.getContentType())!==!1){const[p,...b]=f?f.split(";").map(y=>y.trim()).filter(Boolean):[];s.setContentType([p||"multipart/form-data",...b].join("; "))}}let l=new XMLHttpRequest;if(e.auth){const p=e.auth.username||"",b=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";s.set("Authorization","Basic "+btoa(p+":"+b))}const g=It(e.baseURL,e.url);l.open(e.method.toUpperCase(),_t(g,e.params,e.paramsSerializer),!0),l.timeout=e.timeout;function v(){if(!l)return;const p=M.from("getAllResponseHeaders"in l&&l.getAllResponseHeaders()),y={data:!i||i==="text"||i==="json"?l.responseText:l.response,status:l.status,statusText:l.statusText,headers:p,config:e,request:l};kr(function(P){n(P),d()},function(P){r(P),d()},y),l=null}if("onloadend"in l?l.onloadend=v:l.onreadystatechange=function(){!l||l.readyState!==4||l.status===0&&!(l.responseURL&&l.responseURL.indexOf("file:")===0)||setTimeout(v)},l.onabort=function(){l&&(r(new m("Request aborted",m.ECONNABORTED,e,l)),l=null)},l.onerror=function(){r(new m("Network Error",m.ERR_NETWORK,e,l)),l=null},l.ontimeout=function(){let b=e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded";const y=e.transitional||Ft;e.timeoutErrorMessage&&(b=e.timeoutErrorMessage),r(new m(b,y.clarifyTimeoutError?m.ETIMEDOUT:m.ECONNABORTED,e,l)),l=null},L.hasStandardBrowserEnv&&(a&&c.isFunction(a)&&(a=a(e)),a||a!==!1&&_r(g))){const p=e.xsrfHeaderName&&e.xsrfCookieName&&Nr.read(e.xsrfCookieName);p&&s.set(e.xsrfHeaderName,p)}o===void 0&&s.setContentType(null),"setRequestHeader"in l&&c.forEach(s.toJSON(),function(b,y){l.setRequestHeader(y,b)}),c.isUndefined(e.withCredentials)||(l.withCredentials=!!e.withCredentials),i&&i!=="json"&&(l.responseType=e.responseType),typeof e.onDownloadProgress=="function"&&l.addEventListener("progress",ct(e.onDownloadProgress,!0)),typeof e.onUploadProgress=="function"&&l.upload&&l.upload.addEventListener("progress",ct(e.onUploadProgress)),(e.cancelToken||e.signal)&&(u=p=>{l&&(r(!p||p.type?new ie(null,e,l):p),l.abort(),l=null)},e.cancelToken&&e.cancelToken.subscribe(u),e.signal&&(e.signal.aborted?u():e.signal.addEventListener("abort",u)));const h=Fr(g);if(h&&L.protocols.indexOf(h)===-1){r(new m("Unsupported protocol "+h+":",m.ERR_BAD_REQUEST,e));return}l.send(o||null)})},Le={http:ur,xhr:Dr};c.forEach(Le,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const lt=e=>`- ${e}`,Ir=e=>c.isFunction(e)||e===null||e===!1,Vt={getAdapter:e=>{e=c.isArray(e)?e:[e];const{length:t}=e;let n,r;const o={};for(let s=0;s<t;s++){n=e[s];let i;if(r=n,!Ir(n)&&(r=Le[(i=String(n)).toLowerCase()],r===void 0))throw new m(`Unknown adapter '${i}'`);if(r)break;o[i||"#"+s]=r}if(!r){const s=Object.entries(o).map(([a,u])=>`adapter ${a} `+(u===!1?"is not supported by the environment":"is not available in the build"));let i=t?s.length>1?`since :
`+s.map(lt).join(`
`):" "+lt(s[0]):"as no adapter specified";throw new m("There is no suitable adapter to dispatch the request "+i,"ERR_NOT_SUPPORT")}return r},adapters:Le};function xe(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new ie(null,e)}function ut(e){return xe(e),e.headers=M.from(e.headers),e.data=We.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),Vt.getAdapter(e.adapter||Ie.adapter)(e).then(function(r){return xe(e),r.data=We.call(e,e.transformResponse,r),r.headers=M.from(r.headers),r},function(r){return Dt(r)||(xe(e),r&&r.response&&(r.response.data=We.call(e,e.transformResponse,r.response),r.response.headers=M.from(r.response.headers))),Promise.reject(r)})}const ft=e=>e instanceof M?{...e}:e;function K(e,t){t=t||{};const n={};function r(d,f,l){return c.isPlainObject(d)&&c.isPlainObject(f)?c.merge.call({caseless:l},d,f):c.isPlainObject(f)?c.merge({},f):c.isArray(f)?f.slice():f}function o(d,f,l){if(c.isUndefined(f)){if(!c.isUndefined(d))return r(void 0,d,l)}else return r(d,f,l)}function s(d,f){if(!c.isUndefined(f))return r(void 0,f)}function i(d,f){if(c.isUndefined(f)){if(!c.isUndefined(d))return r(void 0,d)}else return r(void 0,f)}function a(d,f,l){if(l in t)return r(d,f);if(l in e)return r(void 0,d)}const u={url:s,method:s,data:s,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,withXSRFToken:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:a,headers:(d,f)=>o(ft(d),ft(f),!0)};return c.forEach(Object.keys(Object.assign({},e,t)),function(f){const l=u[f]||o,g=l(e[f],t[f],f);c.isUndefined(g)&&l!==a||(n[f]=g)}),n}const Ht="1.6.8",Ve={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Ve[e]=function(r){return typeof r===e||"a"+(t<1?"n ":" ")+e}});const pt={};Ve.transitional=function(t,n,r){function o(s,i){return"[Axios v"+Ht+"] Transitional option '"+s+"'"+i+(r?". "+r:"")}return(s,i,a)=>{if(t===!1)throw new m(o(i," has been removed"+(n?" in "+n:"")),m.ERR_DEPRECATED);return n&&!pt[i]&&(pt[i]=!0,console.warn(o(i," has been deprecated since v"+n+" and will be removed in the near future"))),t?t(s,i,a):!0}};function Vr(e,t,n){if(typeof e!="object")throw new m("options must be an object",m.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let o=r.length;for(;o-- >0;){const s=r[o],i=t[s];if(i){const a=e[s],u=a===void 0||i(a,s,e);if(u!==!0)throw new m("option "+s+" must be "+u,m.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new m("Unknown option "+s,m.ERR_BAD_OPTION)}}const ke={assertOptions:Vr,validators:Ve},F=ke.validators;class pe{constructor(t){this.defaults=t,this.interceptors={request:new it,response:new it}}async request(t,n){try{return await this._request(t,n)}catch(r){if(r instanceof Error){let o;Error.captureStackTrace?Error.captureStackTrace(o={}):o=new Error;const s=o.stack?o.stack.replace(/^.+\n/,""):"";r.stack?s&&!String(r.stack).endsWith(s.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+s):r.stack=s}throw r}}_request(t,n){typeof t=="string"?(n=n||{},n.url=t):n=t||{},n=K(this.defaults,n);const{transitional:r,paramsSerializer:o,headers:s}=n;r!==void 0&&ke.assertOptions(r,{silentJSONParsing:F.transitional(F.boolean),forcedJSONParsing:F.transitional(F.boolean),clarifyTimeoutError:F.transitional(F.boolean)},!1),o!=null&&(c.isFunction(o)?n.paramsSerializer={serialize:o}:ke.assertOptions(o,{encode:F.function,serialize:F.function},!0)),n.method=(n.method||this.defaults.method||"get").toLowerCase();let i=s&&c.merge(s.common,s[n.method]);s&&c.forEach(["delete","get","head","post","put","patch","common"],h=>{delete s[h]}),n.headers=M.concat(i,s);const a=[];let u=!0;this.interceptors.request.forEach(function(p){typeof p.runWhen=="function"&&p.runWhen(n)===!1||(u=u&&p.synchronous,a.unshift(p.fulfilled,p.rejected))});const d=[];this.interceptors.response.forEach(function(p){d.push(p.fulfilled,p.rejected)});let f,l=0,g;if(!u){const h=[ut.bind(this),void 0];for(h.unshift.apply(h,a),h.push.apply(h,d),g=h.length,f=Promise.resolve(n);l<g;)f=f.then(h[l++],h[l++]);return f}g=a.length;let v=n;for(l=0;l<g;){const h=a[l++],p=a[l++];try{v=h(v)}catch(b){p.call(this,b);break}}try{f=ut.call(this,v)}catch(h){return Promise.reject(h)}for(l=0,g=d.length;l<g;)f=f.then(d[l++],d[l++]);return f}getUri(t){t=K(this.defaults,t);const n=It(t.baseURL,t.url);return _t(n,t.params,t.paramsSerializer)}}c.forEach(["delete","get","head","options"],function(t){pe.prototype[t]=function(n,r){return this.request(K(r||{},{method:t,url:n,data:(r||{}).data}))}});c.forEach(["post","put","patch"],function(t){function n(r){return function(s,i,a){return this.request(K(a||{},{method:t,headers:r?{"Content-Type":"multipart/form-data"}:{},url:s,data:i}))}}pe.prototype[t]=n(),pe.prototype[t+"Form"]=n(!0)});const le=pe;class He{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(s){n=s});const r=this;this.promise.then(o=>{if(!r._listeners)return;let s=r._listeners.length;for(;s-- >0;)r._listeners[s](o);r._listeners=null}),this.promise.then=o=>{let s;const i=new Promise(a=>{r.subscribe(a),s=a}).then(o);return i.cancel=function(){r.unsubscribe(s)},i},t(function(s,i,a){r.reason||(r.reason=new ie(s,i,a),n(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const n=this._listeners.indexOf(t);n!==-1&&this._listeners.splice(n,1)}static source(){let t;return{token:new He(function(o){t=o}),cancel:t}}}const Hr=He;function qr(e){return function(n){return e.apply(null,n)}}function $r(e){return c.isObject(e)&&e.isAxiosError===!0}const Ne={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Ne).forEach(([e,t])=>{Ne[t]=e});const zr=Ne;function qt(e){const t=new le(e),n=Tt(le.prototype.request,t);return c.extend(n,le.prototype,t,{allOwnKeys:!0}),c.extend(n,t,null,{allOwnKeys:!0}),n.create=function(o){return qt(K(e,o))},n}const S=qt(Ie);S.Axios=le;S.CanceledError=ie;S.CancelToken=Hr;S.isCancel=Dt;S.VERSION=Ht;S.toFormData=we;S.AxiosError=m;S.Cancel=S.CanceledError;S.all=function(t){return Promise.all(t)};S.spread=qr;S.isAxiosError=$r;S.mergeConfig=K;S.AxiosHeaders=M;S.formToJSON=e=>jt(c.isHTMLForm(e)?new FormData(e):e);S.getAdapter=Vt.getAdapter;S.HttpStatusCode=zr;S.default=S;const $t=S,Z=$t.create({baseURL:"https://polyglot-api-staging.polyglot-edu.com",headers:{"Content-Type":"application/json"}}),dt=$t.create({baseURL:"https://papygame.tech/api/v1",headers:{"Content-Type":"application/json"}}),de={getLPList:()=>Z.get("/api/flows/"),getActualNode:e=>Z.post("/api/execution/actual",e),getFirstNode:e=>Z.post("/api/execution/first",e),getNextNode:e=>Z.post("/api/execution/next",e),loadFlowList:e=>{const t=e?"?q="+e:"";return Z.get("/api/flows"+t)},createAssigmentPapyrus:e=>dt.post("/newBlankProject",e),userPapyPoints:e=>dt.get("/graderResults?project_id="+e)};let qe="https://admin.workadventu.re";function $e(){const e=WA.player.userRoomToken;if(e===void 0)throw new Error("No userRoomToken found. The quests plugin can only work with WorkAdventure SAAS edition (at https://play.workadventu.re).");return e}async function Gr(e){const t=new URL(`/api/quests/${e}`,qe);t.search=new URLSearchParams({room:WA.room.id}).toString();const n=await fetch(t,{method:"GET",headers:{Authorization:$e()}});if(!n.ok)throw new Error(`An error occurred. HTTP Code: ${n.status} ${n.statusText}.`);return await n.json()}async function q(e,t){if(!WA.player.isLogged)throw new Error("You must be logged to gain XP.");const n=new URL(`/api/quests/${e}/level-up`,qe),r=await fetch(n,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:$e()},body:JSON.stringify({xp:t})});if(!r.ok)throw new Error(`An error occurred. HTTP Code: ${r.status} ${r.statusText}.`);const o=await r.json();return o.awardedBadges.length>0&&(async()=>{for(const s of o.awardedBadges)await Jr(e,s)})().catch(s=>{console.error(s)}),o}async function Jr(e,t){const n=new URL(`/quests/${e}/badge/${t}/congratulations`,qe);n.search=new URLSearchParams({token:$e()}).toString(),await WA.ui.website.open({url:n.toString(),position:{vertical:"middle",horizontal:"middle"},allowApi:!0,visible:!0,size:{width:"100%",height:"100%"}})}const ue=[{key:"keyLP",cases:["learningPath"],generalPoints:100},{key:"codingKey",cases:["VSCode"],generalPoints:100},{key:"collaborativeKey",cases:["Eraser"],generalPoints:100},{key:"demo2024event",cases:["PapyrusWeb"],generalPoints:100},{key:"knowledgeKey",cases:["WebApp"],generalPoints:100},{key:"generalKey",cases:[],generalPoints:100}];console.log("Script started successfully");let W,A,$,C,z,ee,fe,V=[{x:0,y:0}],he,ht,O;function B(){C!==void 0&&(C.close(),C=void 0)}function D(){$!==void 0&&($.close(),$=void 0)}function _(){z!==void 0&&(z.close(),z=void 0)}function I(){ee!==void 0&&(ee.close(),ee=void 0)}function Kr(){fe!==void 0&&(fe.close(),fe=void 0)}function yt(){WA.player.state.actualFlow&&(WA.state.door=!0),WA.state.door?(WA.room.showLayer("main_door_open"),WA.room.hideLayer("main_door_close"),WA.room.hideLayer("collision_main_door"),console.log("open")):(WA.room.hideLayer("main_door_open"),WA.room.showLayer("main_door_close"),WA.room.showLayer("collision_main_door"),console.log("close"))}function mt(e,t){_(),z=WA.ui.openPopup(e,"Wrong area, here you are able to make activity connected to "+t,[{label:"Close",className:"normal",callback:()=>{_()}}]),setTimeout(function(){_()},3e3)}async function ye(){const e=await WA.player.getPosition();console.log(e.y);const t=e.y>300?"bannerNarrative2":"bannerNarrative1";let n=`The city of Technopolis is falling apart. Its digital infrastructure, once the envy of the world, is now in chaos due to a centuries-old, corrupted system architecture. As an appointed Architect of Code, your task is to restore stability. But this mission is not yours alonethere are others, racing against you to solve Technopolis' problems and earn the title of Grand Architect. 
You'll traverse a sprawling digital city using a 2D map to navigate through different rooms where critical missions await. Every room contains learning challenges related to UML Modeling and in particular Class diagrams. Along the way, you'll collect points, badges, and level up, but only the top three learners will appear on the final Leaderboard, earning the ultimate rewards.`;A&&(n=A.description),O=WA.ui.displayActionMessage({message:"press 'space' or click here to open the narrative",callback:async()=>{I(),fe=WA.ui.openPopup(t,n,[{label:"Close",className:"normal",callback:()=>{ye(),O.remove(),Kr()}}]),setTimeout(function(){I(),ye(),O.remove()},8e3)}})}const Yr=[{platform:["VSCode"],activityType:4,pos:{x:12,y:6}},{platform:["WebApp"],activityType:1,pos:{x:25,y:5}},{platform:["Eraser","PapyrusWeb"],activityType:3,pos:{x:17,y:4}}];let E={x:0,y:0};async function U(e){let t="";A&&(t=A.platform),await ze(t),_(),z=WA.ui.openPopup(e,'Your next activity is in "'+A.platform+'", go to the correct area.',[{label:"Close",className:"normal",callback:()=>{_()}}]),setTimeout(function(){_()},3e3),Yr.map(i=>{i.platform.includes(A.platform)&&(E={x:i.pos.x,y:i.pos.y+2}),WA.room.setTiles([{x:i.pos.x,y:i.pos.y,tile:i.platform.includes(A.platform)?"arrowBase":null,layer:"activity/Type5"}])});let n=await WA.player.getPosition(),r;do r=V.pop(),r&&WA.room.setTiles([{x:r.x,y:r.y,tile:null,layer:"activity/Type5"}]);while(r);n={x:Math.floor(n.x/33),y:Math.floor(n.y/33)};let o=0,s;if(E.x!=0)do if(o++,s=!(Math.abs(n.y-E.y)<3&&Math.abs(n.x-E.x)<3),Math.abs(n.y-E.y)>1){const i=n.x,a=n.y+(n.y<E.y?2:-2);WA.room.setTiles([{x:i,y:a,tile:"pointerBase",layer:"activity/Type5"}]),V.push({x:i,y:a}),n={x:i,y:a}}else if(Math.abs(n.x-E.x)>1){const i=n.x+(n.x<E.x?2:-2),a=n.y;WA.room.setTiles([{x:i,y:a,tile:"pointerBase",layer:"activity/Type5"}]),V.push({x:i,y:a}),n={x:i,y:a}}while(s&&o<20)}WA.player.onPlayerMove(async()=>{if(E.x==0)return;let e;do e=V.pop(),e&&WA.room.setTiles([{x:e.x,y:e.y,tile:null,layer:"activity/Type5"}]);while(e);let t=await WA.player.getPosition();t={x:Math.floor(t.x/33),y:Math.floor(t.y/33)};let n=0,r;if(E.x!=0)do if(n++,r=!(Math.abs(t.y-E.y)<3&&Math.abs(t.x-E.x)<3),Math.abs(t.y-E.y)>1){const o=t.x,s=t.y+(t.y<E.y?2:-2);WA.room.setTiles([{x:o,y:s,tile:"pointerBase",layer:"activity/Type5"}]),V.push({x:o,y:s}),t={x:o,y:s}}else if(Math.abs(t.x-E.x)>1){const o=t.x+(t.x<E.x?2:-2),s=t.y;WA.room.setTiles([{x:o,y:s,tile:"pointerBase",layer:"activity/Type5"}]),V.push({x:o,y:s}),t={x:o,y:s}}while(r&&n<20)});async function ze(e){try{if(console.log("getActual"),!W)throw"No ctx detected";await de.getActualNode({ctxId:W}).then(async t=>{var n;if(console.log(t.data.platform),A&&t.data.platform!=A.platform)if(A.platform=="PapyrusWeb"&&he){const r=(await de.userPapyPoints(he)).data;console.log(r.Grade);const o=r.Grade.indexOf(" out"),s=parseInt(r.Grade.substring(0,o));console.log(s),await q("UMLKey",s*10).then(async i=>{var a;i.awardedBadges!=null&&await q("generalKey",((a=ue.find(u=>u.key=="UMLKey"))==null?void 0:a.generalPoints)??0)}).catch(i=>console.log(i))}else{try{await q(((n=ue.find(r=>r.cases.includes(A.platform)))==null?void 0:n.key)??"",50).then(async r=>{var o;r.awardedBadges!=null&&await q("generalKey",((o=ue.find(s=>s.cases.includes(A.platform)))==null?void 0:o.generalPoints)??0)}).catch(r=>console.log(r))}catch(r){console.log(r)}console.log("platform point given")}A=t.data,console.log(A.validation),!A.validation[0]&&e==A.platform&&(console.log("LP point given"),await q("keyLP",100).catch(r=>console.log(r)),WA.player.state.actualFlow="",W=void 0)}).catch(async t=>{if(console.log(t),t.response.status&&t.response.status==400){console.log("ctx reset"),console.log(String(WA.player.state.actualFlow)),await zt(String(WA.player.state.actualFlow)).then(async()=>{console.log("new activity correctly"),await ze("reset")});return}throw console.error("Error:",t.response.status,t.response.statusText),new Error(`HTTP error! Status: ${t.response.status}`)})}catch(t){throw console.error("Error:",t),t}}async function zt(e){try{const t=WA.player.name,n=await de.getFirstNode({flowId:e,username:t});if(console.log(e),n.status!=200)throw console.error("Error:",n.status,n.statusText),new Error(`HTTP error! Status: ${n.status}`);W=n.data.ctx;let r=WA.player.state.flows;r!=null?r.find(o=>o!=null?e==o.flowId:!1)?r.find(o=>o?e==o.flowId:!1).ctx=W:r[r.length+1]={flowId:e,ctx:W}:r=[{flowId:e,ctx:W}],WA.player.state.flows=r,console.log("starting activity done");return}catch(t){throw console.error("Error:",t),t}}WA.onInit().then(async()=>{(WA.player.name=="Tmao"||WA.player.name=="Antonio Bucchiarone")&&WA.room.hideLayer("collision_manager_door"),console.log("Scripting API ready"),WA.room.website.create({name:"logo",url:"./images/solo_logo_32.png",position:{x:220,y:496,width:64,height:64},visible:!0,origin:"map",scale:1}),yt(),WA.room.website.create({name:"scritta",url:"./images/solo_scritta_32.png",position:{x:388,y:496,width:418,height:64},visible:!0,origin:"map",scale:1}),ye(),WA.room.area.onLeave("Outside").subscribe(async()=>{E={x:0,y:0};let e;do e=V.pop(),e&&WA.room.setTiles([{x:e.x,y:e.y,tile:null,layer:"activity/Type5"}]);while(e)}),WA.room.area.onEnter("Entry").subscribe(async()=>{try{if(I(),!WA.player.state.actualFlow){ee=WA.ui.openPopup("instructions","You have not selected a Learning Path, please go to the menu area to choose a path.",[{label:"Close",className:"normal",callback:()=>{I()}}]),setTimeout(function(){I()},3e3);return}console.log(WA.player.state.actualFlow);const e=WA.player.state.flows;if(e!=null&&e.find(t=>(t==null?void 0:t.flowId)==WA.player.state.actualFlow)!=null){W=e.find(t=>(t==null?void 0:t.flowId)==WA.player.state.actualFlow).ctx,console.log("ctx already created, continue activity"),U("instructions");return}console.log("starting activity"),await zt(String(WA.player.state.actualFlow)),await ze("instruction"),U("instructions")}catch(e){console.error("Failed to get API response:",e)}}),WA.room.area.onEnter("FlowsMenu").subscribe(async()=>{try{console.log("testing FlowsMenu"),$=WA.ui.openPopup("MenuBanner","Here you can choose which learning path you want to do, access the console to see the possibilities",[{label:"Close",className:"normal",callback:()=>{D()}}]),setTimeout(function(){D()},3e3),C=await WA.nav.openCoWebSite("https://polyglot-webapp.polyglot-edu.com/flowMenu",!0,void 0,55)}catch{}}),WA.room.area.onLeave("FlowsMenu").subscribe(async()=>{B()}),WA.room.area.onEnter("activityManager").subscribe(async()=>{try{console.log("testing FlowsMenu"),$=WA.ui.openPopup("MenuBanner","Here you can choose which learning path you want to do, access the console to see the possibilities",[{label:"Close",className:"normal",callback:()=>{D()}}]),setTimeout(function(){D()},3e3),C=await WA.nav.openCoWebSite("https://staging.polyglot-edu.com/waEducator",!0,void 0,55)}catch{}}),WA.room.area.onLeave("activityManager").subscribe(async()=>{B()}),WA.room.area.onEnter("creativeArea").subscribe(async()=>{try{console.log("area Activity5"),z=WA.ui.openPopup("BannerA5","This area is creative area, here you can access the Learning Path editor to create your personal path",[{label:"Close",className:"normal",callback:()=>{_()}}]),setTimeout(function(){_()},3e3),C=await WA.nav.openCoWebSite("https://staging.polyglot-edu.com/flows",!0,void 0,55)}catch(e){console.error("Failed to get API response:",e)}}),WA.room.area.onLeave("creativeArea").subscribe(async()=>{U("BannerA5"),B()}),WA.room.area.onEnter("instructions").subscribe(()=>{try{if(O.remove(),!WA.player.state.actualFlow){O=WA.ui.displayActionMessage({message:"press 'space' or click here to open the instruction WebPage",callback:async()=>{ee=WA.ui.openPopup("instructions","You have not selected a Learning Path, please go to the menu area to choose a path.",[{label:"Close",className:"normal",callback:()=>{I()}}]),setTimeout(function(){I()},3e3)}});return}O=WA.ui.displayActionMessage({message:"press 'space' or click here to open the instruction WebPage",callback:async()=>{C=await WA.nav.openCoWebSite("https://polyglot-webapp.polyglot-edu.com/flowShower/"+WA.player.state.actualFlow,!0,void 0,55)}})}catch(e){console.log(e)}}),WA.room.area.onLeave("instructions").subscribe(async()=>{O.remove(),ye(),B()}),WA.player.state.onVariableChange("actualFlow").subscribe(()=>{B(),D(),yt(),$=WA.ui.openPopup("MenuBanner","Learning path chose correctly, enter the school zone to start ",[{label:"Close",className:"normal",callback:()=>{D()}}]),setTimeout(function(){D()},3e3),console.log("website closed")}),WA.player.state.onVariableChange("platform").subscribe(e=>{e!="WebApp"&&(B(),console.log("website closed"),U("BannerA1"))}),WA.room.area.onEnter("ActivityType1").subscribe(async()=>{try{if(console.log("testing ACTIVITYTYPE1"),A.platform!="WebApp"){console.log("wrong spot, go to another area"),mt("BannerA1","WebApp");return}const e="https://polyglot-webapp.polyglot-edu.com/tools/"+W;C=await WA.nav.openCoWebSite(e,!0),console.log(e)}catch{}}),WA.room.area.onLeave("ActivityType1").subscribe(async()=>{B(),U("BannerA1")}),WA.room.area.onEnter("ActivityType2").subscribe(async()=>{console.log("ctx:",W);try{console.log("testing ACTIVITYTYPE2")}catch(e){console.error("Failed to get API response:",e)}}),WA.room.area.onLeave("ActivityType2").subscribe(async()=>{U("BannerA2")}),WA.room.area.onEnter("ActivityType3").subscribe(async()=>{try{if(console.log("area Activity3"),A.platform=="PapyrusWeb"){const e=WA.ui.openPopup("BannerA3","Loading your assignment inside PapyrusWeb, wait a moment",[]);setTimeout(function(){e.close()},3e3),await de.createAssigmentPapyrus({ctxId:W||"",assignment_id:A.data.idUML,nomeUtente:WA.player.name}).then(async t=>{he=t.data.project_id,ht=t.data.representation_id,C=await WA.nav.openCoWebSite("https://papygame.tech/projects/"+he+"/edit/"+ht+"?ctxId="+W,!0)}).catch(async t=>{throw console.log(t),new Error(`HTTP error! Status: ${t.response.status}`)})}else A.platform=="Collaborative"&&(C=await WA.nav.openCoWebSite("https://app.eraser.io/workspace/JVoolrO5JJucnQkr1tK7?origin=share",!0))}catch(e){console.error("Failed to get API response:",e)}}),WA.room.area.onLeave("ActivityType3").subscribe(async()=>{U("BannerA3"),B()}),WA.room.area.onEnter("ActivityType4").subscribe(async()=>{try{if(A.platform!="VSCode"){mt("BannerA4","VSCode");return}_(),WA.ui.openPopup("BannerA4","Your next activity is coding assessment. Click Open Notebook to open the notebook directly on your VSCode Editor",[{label:"Open Notebook",className:"normal",callback:()=>{WA.nav.openTab("vscode://ms-dotnettools.dotnet-interactive-vscode/openNotebook?url=https://polyglot-api-staging.polyglot-edu.com/api/flows/"+W+"/run/notebook.dib"),console.log("aa")}},{label:"Close",className:"normal",callback:e=>{e.close()}}]),O=WA.ui.displayActionMessage({message:"press 'space' or click here to open the instruction WebPage",callback:async()=>{window.open("vscode://ms-dotnettools.dotnet-interactive-vscode/openNotebook?url=https://polyglot-api-staging.polyglot-edu.com/api/flows/"+W+"/run/notebook.dib","_blank")}})}catch(e){console.error("Failed to get API response:",e)}}),WA.room.area.onLeave("ActivityType4").subscribe(async()=>{U("BannerA4")}),WA.room.area.onEnter("cleaningArea").subscribe(()=>{try{O=WA.ui.displayActionMessage({message:"Attention, if you press 'space' or click here to clean your points",callback:async()=>{console.log("deleting point"),ue.map(async e=>{const t=await Gr(e.key);console.log(t),t&&await q(e.key,-t.xp)}),console.log("Points removed from the player")}});return}catch(e){console.log(e)}}),WA.room.area.onLeave("cleaningArea").subscribe(async()=>{O.remove(),B()}),Cn().then(()=>{console.log("Scripting API Extra ready")}).catch(e=>console.error(e))}).catch(e=>console.error(e));
