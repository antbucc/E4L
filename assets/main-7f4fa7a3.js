class J{constructor(t){this.properties=t??[]}get(t){const n=this.properties.filter(r=>r.name===t).map(r=>r.value);if(n.length>1)throw new Error('Expected only one property to be named "'+t+'"');if(n.length!==0)return n[0]}getString(t){return this.getByType(t,"string")}getNumber(t){return this.getByType(t,"number")}getBoolean(t){return this.getByType(t,"boolean")}getByType(t,n){const r=this.get(t);if(r!==void 0){if(n!=="json"&&typeof r!==n)throw new Error('Expected property "'+t+'" to have type "'+n+'"');return r}}mustGetString(t){return this.mustGetByType(t,"string")}mustGetNumber(t){return this.mustGetByType(t,"number")}mustGetBoolean(t){return this.mustGetByType(t,"boolean")}mustGetByType(t,n){const r=this.get(t);if(r===void 0)throw new Error('Property "'+t+'" is missing');if(n!=="json"&&typeof r!==n)throw new Error('Expected property "'+t+'" to have type "'+n+'"');return r}getType(t){const n=this.properties.filter(r=>r.name===t).map(r=>r.type);if(n.length>1)throw new Error('Expected only one property to be named "'+t+'"');if(n.length!==0)return n[0]}}const Ne="https://unpkg.com/@workadventure/scripting-api-extra@1.4.8/dist";class zt{constructor(t){this.name=t.name,this.x=t.x,this.y=t.y,this.properties=new J(t.properties)}get isReadable(){const t=this.properties.getString("readableBy");return t?WA.player.tags.includes(t):!0}get isWritable(){const t=this.properties.getString("writableBy");return t?WA.player.tags.includes(t):!0}}function ze(e){const t=e?"#"+e.join():"";WA.nav.openCoWebSite(Ne+"/configuration.html"+t)}async function Gt(e,t){const n=await WA.room.getTiledMap(),r=new Map;return yt(n.layers,r,e,t),r}function yt(e,t,n,r){for(const o of e)if(o.type==="objectgroup"){for(const s of o.objects)if(s.type==="variable"||s.class==="variable"){if(n&&o.name!==n||r&&!r.includes(s.name))continue;t.set(s.name,new zt(s))}}else o.type==="group"&&yt(o.layers,t,n,r)}let Se;async function re(){return Se===void 0&&(Se=Jt()),Se}async function Jt(){return Kt(await WA.room.getTiledMap())}function Kt(e){const t=new Map;return gt(e.layers,"",t),t}function gt(e,t,n){for(const r of e)r.type==="group"?gt(r.layers,t+r.name+"/",n):(r.name=t+r.name,n.set(r.name,r))}async function mt(){const e=await re(),t=[];for(const n of e.values())if(n.type==="objectgroup")for(const r of n.objects)(r.type==="area"||r.class==="area")&&t.push(r);return t}function Yt(e){let t=1/0,n=1/0,r=0,o=0;const s=e.data;if(typeof s=="string")throw new Error("Unsupported tile layer data stored as string instead of CSV");for(let i=0;i<e.height;i++)for(let a=0;a<e.width;a++)s[a+i*e.width]!==0&&(t=Math.min(t,a),o=Math.max(o,a),n=Math.min(n,i),r=Math.max(r,i));return{top:n,left:t,right:o+1,bottom:r+1}}function bt(e){let t=1/0,n=1/0,r=0,o=0;for(const s of e){const i=Yt(s);i.left<t&&(t=i.left),i.top<n&&(n=i.top),i.right>o&&(o=i.right),i.bottom>r&&(r=i.bottom)}return{top:n,left:t,right:o,bottom:r}}/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */var Xt=Object.prototype.toString,X=Array.isArray||function(t){return Xt.call(t)==="[object Array]"};function Be(e){return typeof e=="function"}function Qt(e){return X(e)?"array":typeof e}function ve(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function Ge(e,t){return e!=null&&typeof e=="object"&&t in e}function Zt(e,t){return e!=null&&typeof e!="object"&&e.hasOwnProperty&&e.hasOwnProperty(t)}var en=RegExp.prototype.test;function tn(e,t){return en.call(e,t)}var nn=/\S/;function rn(e){return!tn(nn,e)}var on={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};function sn(e){return String(e).replace(/[&<>"'`=\/]/g,function(n){return on[n]})}var an=/\s*/,cn=/\s+/,Je=/\s*=/,ln=/\s*\}/,un=/#|\^|\/|>|\{|&|=|!/;function fn(e,t){if(!e)return[];var n=!1,r=[],o=[],s=[],i=!1,a=!1,u="",d=0;function f(){if(i&&!a)for(;s.length;)delete o[s.pop()];else s=[];i=!1,a=!1}var l,m,v;function h(N){if(typeof N=="string"&&(N=N.split(cn,2)),!X(N)||N.length!==2)throw new Error("Invalid tags: "+N);l=new RegExp(ve(N[0])+"\\s*"),m=new RegExp("\\s*"+ve(N[1])),v=new RegExp("\\s*"+ve("}"+N[1]))}h(t||x.tags);for(var p=new oe(e),b,y,w,P,H,D;!p.eos();){if(b=p.pos,w=p.scanUntil(l),w)for(var Ae=0,$t=w.length;Ae<$t;++Ae)P=w.charAt(Ae),rn(P)?(s.push(o.length),u+=P):(a=!0,n=!0,u+=" "),o.push(["text",P,b,b+1]),b+=1,P===`
`&&(f(),u="",d=0,n=!1);if(!p.scan(l))break;if(i=!0,y=p.scan(un)||"name",p.scan(an),y==="="?(w=p.scanUntil(Je),p.scan(Je),p.scanUntil(m)):y==="{"?(w=p.scanUntil(v),p.scan(ln),p.scanUntil(m),y="&"):w=p.scanUntil(m),!p.scan(m))throw new Error("Unclosed tag at "+p.pos);if(y==">"?H=[y,w,b,p.pos,u,d,n]:H=[y,w,b,p.pos],d++,o.push(H),y==="#"||y==="^")r.push(H);else if(y==="/"){if(D=r.pop(),!D)throw new Error('Unopened section "'+w+'" at '+b);if(D[1]!==w)throw new Error('Unclosed section "'+D[1]+'" at '+b)}else y==="name"||y==="{"||y==="&"?a=!0:y==="="&&h(w)}if(f(),D=r.pop(),D)throw new Error('Unclosed section "'+D[1]+'" at '+p.pos);return dn(pn(o))}function pn(e){for(var t=[],n,r,o=0,s=e.length;o<s;++o)n=e[o],n&&(n[0]==="text"&&r&&r[0]==="text"?(r[1]+=n[1],r[3]=n[3]):(t.push(n),r=n));return t}function dn(e){for(var t=[],n=t,r=[],o,s,i=0,a=e.length;i<a;++i)switch(o=e[i],o[0]){case"#":case"^":n.push(o),r.push(o),n=o[4]=[];break;case"/":s=r.pop(),s[5]=o[2],n=r.length>0?r[r.length-1][4]:t;break;default:n.push(o)}return t}function oe(e){this.string=e,this.tail=e,this.pos=0}oe.prototype.eos=function(){return this.tail===""};oe.prototype.scan=function(t){var n=this.tail.match(t);if(!n||n.index!==0)return"";var r=n[0];return this.tail=this.tail.substring(r.length),this.pos+=r.length,r};oe.prototype.scanUntil=function(t){var n=this.tail.search(t),r;switch(n){case-1:r=this.tail,this.tail="";break;case 0:r="";break;default:r=this.tail.substring(0,n),this.tail=this.tail.substring(n)}return this.pos+=r.length,r};function K(e,t){this.view=e,this.cache={".":this.view},this.parent=t}K.prototype.push=function(t){return new K(t,this)};K.prototype.lookup=function(t){var n=this.cache,r;if(n.hasOwnProperty(t))r=n[t];else{for(var o=this,s,i,a,u=!1;o;){if(t.indexOf(".")>0)for(s=o.view,i=t.split("."),a=0;s!=null&&a<i.length;)a===i.length-1&&(u=Ge(s,i[a])||Zt(s,i[a])),s=s[i[a++]];else s=o.view[t],u=Ge(o.view,t);if(u){r=s;break}o=o.parent}n[t]=r}return Be(r)&&(r=r.call(this.view)),r};function T(){this.templateCache={_cache:{},set:function(t,n){this._cache[t]=n},get:function(t){return this._cache[t]},clear:function(){this._cache={}}}}T.prototype.clearCache=function(){typeof this.templateCache<"u"&&this.templateCache.clear()};T.prototype.parse=function(t,n){var r=this.templateCache,o=t+":"+(n||x.tags).join(":"),s=typeof r<"u",i=s?r.get(o):void 0;return i==null&&(i=fn(t,n),s&&r.set(o,i)),i};T.prototype.render=function(t,n,r,o){var s=this.getConfigTags(o),i=this.parse(t,s),a=n instanceof K?n:new K(n,void 0);return this.renderTokens(i,a,r,t,o)};T.prototype.renderTokens=function(t,n,r,o,s){for(var i="",a,u,d,f=0,l=t.length;f<l;++f)d=void 0,a=t[f],u=a[0],u==="#"?d=this.renderSection(a,n,r,o,s):u==="^"?d=this.renderInverted(a,n,r,o,s):u===">"?d=this.renderPartial(a,n,r,s):u==="&"?d=this.unescapedValue(a,n):u==="name"?d=this.escapedValue(a,n,s):u==="text"&&(d=this.rawValue(a)),d!==void 0&&(i+=d);return i};T.prototype.renderSection=function(t,n,r,o,s){var i=this,a="",u=n.lookup(t[1]);function d(m){return i.render(m,n,r,s)}if(u){if(X(u))for(var f=0,l=u.length;f<l;++f)a+=this.renderTokens(t[4],n.push(u[f]),r,o,s);else if(typeof u=="object"||typeof u=="string"||typeof u=="number")a+=this.renderTokens(t[4],n.push(u),r,o,s);else if(Be(u)){if(typeof o!="string")throw new Error("Cannot use higher-order sections without the original template");u=u.call(n.view,o.slice(t[3],t[5]),d),u!=null&&(a+=u)}else a+=this.renderTokens(t[4],n,r,o,s);return a}};T.prototype.renderInverted=function(t,n,r,o,s){var i=n.lookup(t[1]);if(!i||X(i)&&i.length===0)return this.renderTokens(t[4],n,r,o,s)};T.prototype.indentPartial=function(t,n,r){for(var o=n.replace(/[^ \t]/g,""),s=t.split(`
`),i=0;i<s.length;i++)s[i].length&&(i>0||!r)&&(s[i]=o+s[i]);return s.join(`
`)};T.prototype.renderPartial=function(t,n,r,o){if(r){var s=this.getConfigTags(o),i=Be(r)?r(t[1]):r[t[1]];if(i!=null){var a=t[6],u=t[5],d=t[4],f=i;u==0&&d&&(f=this.indentPartial(i,d,a));var l=this.parse(f,s);return this.renderTokens(l,n,r,f,o)}}};T.prototype.unescapedValue=function(t,n){var r=n.lookup(t[1]);if(r!=null)return r};T.prototype.escapedValue=function(t,n,r){var o=this.getConfigEscape(r)||x.escape,s=n.lookup(t[1]);if(s!=null)return typeof s=="number"&&o===x.escape?String(s):o(s)};T.prototype.rawValue=function(t){return t[1]};T.prototype.getConfigTags=function(t){return X(t)?t:t&&typeof t=="object"?t.tags:void 0};T.prototype.getConfigEscape=function(t){if(t&&typeof t=="object"&&!X(t))return t.escape};var x={name:"mustache.js",version:"4.2.0",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,Scanner:void 0,Context:void 0,Writer:void 0,set templateCache(e){te.templateCache=e},get templateCache(){return te.templateCache}},te=new T;x.clearCache=function(){return te.clearCache()};x.parse=function(t,n){return te.parse(t,n)};x.render=function(t,n,r,o){if(typeof t!="string")throw new TypeError('Invalid template! Template should be a "string" but "'+Qt(t)+'" was given as the first argument for mustache#render(template, view, partials)');return te.render(t,n,r,o)};x.escape=sn;x.Scanner=oe;x.Context=K;x.Writer=T;class wt{constructor(t,n){this.template=t,this.state=n,this.ast=x.parse(t)}getValue(){return this.value===void 0&&(this.value=x.render(this.template,this.state)),this.value}onChange(t){const n=[];for(const r of this.getUsedVariables().values())n.push(this.state.onVariableChange(r).subscribe(()=>{const o=x.render(this.template,this.state);o!==this.value&&(this.value=o,t(this.value))}));return{unsubscribe:()=>{for(const r of n)r.unsubscribe()}}}isPureString(){return this.ast.length===0||this.ast.length===1&&this.ast[0][0]==="text"}getUsedVariables(){const t=new Set;return this.recursiveGetUsedVariables(this.ast,t),t}recursiveGetUsedVariables(t,n){for(const r of t){const o=r[0],s=r[1],i=r[4];["name","&","#","^"].includes(o)&&n.add(s),i!==void 0&&typeof i!="string"&&this.recursiveGetUsedVariables(i,n)}}}async function hn(){var e;const t=await mt();for(const n of t){const r=(e=n.properties)!==null&&e!==void 0?e:[];for(const o of r){if(o.type==="int"||o.type==="bool"||o.type==="object"||typeof o.value!="string")continue;const s=new wt(o.value,WA.state);if(s.isPureString())continue;const i=s.getValue();await Ke(n.name,o.name,i),s.onChange(async a=>{await Ke(n.name,o.name,a)})}}}async function yn(){var e;const t=await re();for(const[n,r]of t.entries())if(r.type!=="objectgroup"){const o=(e=r.properties)!==null&&e!==void 0?e:[];for(const s of o){if(s.type==="int"||s.type==="bool"||s.type==="object"||typeof s.value!="string")continue;const i=new wt(s.value,WA.state);if(i.isPureString())continue;const a=i.getValue();Ye(n,s.name,a),i.onChange(u=>{Ye(n,s.name,u)})}}}async function Ke(e,t,n){console.log(e),(await WA.room.area.get(e)).setProperty(t,n)}function Ye(e,t,n){WA.room.setProperty(e,t,n),t==="visible"&&(n?WA.room.showLayer(e):WA.room.hideLayer(e))}let xe,Me=0,Fe=0;function Xe(e){if(WA.state[e.name]){let t=e.properties.mustGetString("openLayer");for(const n of t.split(`
`))WA.room.showLayer(n);t=e.properties.mustGetString("closeLayer");for(const n of t.split(`
`))WA.room.hideLayer(n)}else{let t=e.properties.mustGetString("openLayer");for(const n of t.split(`
`))WA.room.hideLayer(n);t=e.properties.mustGetString("closeLayer");for(const n of t.split(`
`))WA.room.showLayer(n)}}function gn(e){const t=e.properties.getString("openSound"),n=e.properties.getNumber("soundRadius");let r=1;if(n){const o=St(e.properties.mustGetString("openLayer").split(`
`));if(o>n)return;r=1-o/n}t&&WA.sound.loadSound(t).play({volume:r})}function mn(e){const t=e.properties.getString("closeSound"),n=e.properties.getNumber("soundRadius");let r=1;if(n){const o=St(e.properties.mustGetString("closeLayer").split(`
`));if(o>n)return;r=1-o/n}t&&WA.sound.loadSound(t).play({volume:r})}function At(e){return e.map(t=>xe.get(t)).filter(t=>(t==null?void 0:t.type)==="tilelayer")}function St(e){const t=At(e),n=bt(t),r=((n.right-n.left)/2+n.left)*32,o=((n.bottom-n.top)/2+n.top)*32;return Math.sqrt(Math.pow(Me-r,2)+Math.pow(Fe-o,2))}function bn(e){WA.state.onVariableChange(e.name).subscribe(()=>{WA.state[e.name]?gn(e):mn(e),Xe(e)}),Xe(e)}function Qe(e,t,n,r){const o=e.name;let s,i,a=!1;const u=n.getString("tag");let d=!0;u&&!WA.player.tags.includes(u)&&(d=!1);const f=!!u;function l(){var y;s&&s.remove(),s=WA.ui.displayActionMessage({message:(y=n.getString("closeTriggerMessage"))!==null&&y!==void 0?y:"Press SPACE to close the door",callback:()=>{WA.state[t.name]=!1,m()}})}function m(){var y;s&&s.remove(),s=WA.ui.displayActionMessage({message:(y=n.getString("openTriggerMessage"))!==null&&y!==void 0?y:"Press SPACE to open the door",callback:()=>{WA.state[t.name]=!0,l()}})}function v(){let y;if(e.type==="tilelayer")y=bt(At(t.properties.mustGetString("closeLayer").split(`
`)));else{if(e.x===void 0||e.y===void 0||e.width===void 0||e.height===void 0)throw new Error(`Doorstep zone "${e.name}" is missing x, y, width or height`);y={top:e.y,left:e.x,right:e.x+e.width,bottom:e.y+e.height}}i=WA.room.website.create({name:"doorKeypad"+o,url:r+"/keypad.html#"+encodeURIComponent(o),position:{x:y.right*32,y:y.top*32,width:32*3,height:32*4},allowApi:!0})}function h(){i&&(WA.room.website.delete(i.name),i=void 0)}function p(){if(a=!0,n.getBoolean("autoOpen")&&d){WA.state[t.name]=!0;return}if(!WA.state[t.name]&&(f&&!d||!f)&&(n.getString("code")||n.getString("codeVariable"))){v();return}d&&(WA.state[t.name]?l():m())}function b(){a=!1,n.getBoolean("autoClose")&&(WA.state[t.name]=!1),s&&s.remove(),h()}e.type==="tilelayer"?(WA.room.onEnterLayer(o).subscribe(p),WA.room.onLeaveLayer(o).subscribe(b)):(WA.room.area.onEnter(o).subscribe(p),WA.room.area.onLeave(o).subscribe(b)),WA.state.onVariableChange(t.name).subscribe(()=>{a&&(!n.getBoolean("autoClose")&&WA.state[t.name]===!0&&l(),i&&WA.state[t.name]===!0&&h(),!n.getBoolean("autoOpen")&&WA.state[t.name]===!1&&m())})}function wn(e){const t=e.properties.mustGetString("bellSound"),n=e.properties.getNumber("soundRadius");let r=1;if(n){const o=Math.sqrt(Math.pow(e.x-Me,2)+Math.pow(e.y-Fe,2));if(o>n)return;r=1-o/n}WA.sound.loadSound(t).play({volume:r})}function An(e){WA.state[e.name]===void 0&&(WA.state[e.name]=0),WA.state.onVariableChange(e.name).subscribe(()=>{WA.state[e.name]&&wn(e)})}function Ze(e,t,n){let r;const o=t.getString("bellPopup");if(n.type==="tilelayer"){const s=n.name;WA.room.onEnterLayer(s).subscribe(()=>{var i;o?r=WA.ui.openPopup(o,"",[{label:(i=t.getString("bellButtonText"))!==null&&i!==void 0?i:"Ring",callback:()=>{WA.state[e]=WA.state[e]+1}}]):WA.state[e]=WA.state[e]+1}),WA.room.onLeaveLayer(s).subscribe(()=>{r&&(r.close(),r=void 0)})}else{const s=n.name;WA.room.area.onEnter(s).subscribe(()=>{var i;o?r=WA.ui.openPopup(o,"",[{label:(i=t.getString("bellButtonText"))!==null&&i!==void 0?i:"Ring",callback:()=>{WA.state[e]=WA.state[e]+1}}]):WA.state[e]=WA.state[e]+1}),WA.room.area.onLeave(s).subscribe(()=>{r&&(r.close(),r=void 0)})}}async function Sn(e){e=e??Ne;const t=await Gt();xe=await re();for(const n of t.values())n.properties.get("door")&&bn(n),n.properties.get("bell")&&An(n);for(const n of xe.values()){const r=new J(n.properties),o=r.getString("doorVariable");if(o&&n.type==="tilelayer"){const i=t.get(o);if(i===void 0)throw new Error('Cannot find variable "'+o+'" referred in the "doorVariable" property of layer "'+n.name+'"');Qe(n,i,r,e)}const s=r.getString("bellVariable");s&&n.type==="tilelayer"&&Ze(s,r,n)}for(const n of await mt()){const r=new J(n.properties),o=r.getString("doorVariable");if(o){const i=t.get(o);if(i===void 0)throw new Error('Cannot find variable "'+o+'" referred in the "doorVariable" property of object "'+n.name+'"');Qe(n,i,r,e)}const s=r.getString("bellVariable");s&&Ze(s,r,n)}WA.player.onPlayerMove(n=>{Me=n.x,Fe=n.y})}function vn(e,t){const n=e.getString("bindVariable");if(n){const r=e.get("enterValue"),o=e.get("leaveValue"),s=e.getString("triggerMessage"),i=e.getString("tag");En(n,t,r,o,s,i)}}function En(e,t,n,r,o,s){s&&!WA.player.tags.includes(s)||(n!==void 0&&WA.room.onEnterLayer(t).subscribe(()=>{o||(WA.state[e]=n)}),r!==void 0&&WA.room.onLeaveLayer(t).subscribe(()=>{WA.state[e]=r}))}async function Tn(){const e=await re();for(const t of e.values()){const n=new J(t.properties);vn(n,t.name)}}let et;async function Pn(e){const t=await WA.room.getTiledMap();e=e??Ne,et=await re();const n=t.layers.find(r=>r.name==="configuration");if(n){const o=new J(n.properties).getString("tag");(!o||WA.player.tags.includes(o))&&WA.ui.registerMenuCommand("Configure the room",()=>{WA.nav.openCoWebSite(e+"/configuration.html",!0)});for(const s of et.values()){const i=new J(s.properties),a=i.getString("openConfig");a&&s.type==="tilelayer"&&Wn(a.split(","),s.name,i)}}}function Wn(e,t,n){let r;const o=n.getString("openConfigAdminTag");let s=!0;o&&!WA.player.tags.includes(o)&&(s=!1);function i(){var u;r&&r.remove(),r=WA.ui.displayActionMessage({message:(u=n.getString("openConfigTriggerMessage"))!==null&&u!==void 0?u:"Press SPACE or touch here to configure",callback:()=>ze(e)})}function a(){WA.nav.closeCoWebSite()}WA.room.onEnterLayer(t).subscribe(()=>{const u=n.getString("openConfigTrigger");s&&(u&&u==="onaction"?i():ze(e))}),WA.room.onLeaveLayer(t).subscribe(()=>{r&&r.remove(),a()})}function xn(){return WA.onInit().then(()=>{Sn().catch(e=>console.error(e)),Tn().catch(e=>console.error(e)),Pn().catch(e=>console.error(e)),yn().catch(e=>console.error(e)),hn().catch(e=>console.error(e))}).catch(e=>console.error(e))}function vt(e,t){return function(){return e.apply(t,arguments)}}const{toString:Rn}=Object.prototype,{getPrototypeOf:_e}=Object,ye=(e=>t=>{const n=Rn.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),L=e=>(e=e.toLowerCase(),t=>ye(t)===e),ge=e=>t=>typeof t===e,{isArray:Q}=Array,ne=ge("undefined");function Cn(e){return e!==null&&!ne(e)&&e.constructor!==null&&!ne(e.constructor)&&R(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const Et=L("ArrayBuffer");function On(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&Et(e.buffer),t}const kn=ge("string"),R=ge("function"),Tt=ge("number"),me=e=>e!==null&&typeof e=="object",Ln=e=>e===!0||e===!1,ae=e=>{if(ye(e)!=="object")return!1;const t=_e(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},Nn=L("Date"),Bn=L("File"),Mn=L("Blob"),Fn=L("FileList"),_n=e=>me(e)&&R(e.pipe),Un=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||R(e.append)&&((t=ye(e))==="formdata"||t==="object"&&R(e.toString)&&e.toString()==="[object FormData]"))},jn=L("URLSearchParams"),Dn=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function se(e,t,{allOwnKeys:n=!1}={}){if(e===null||typeof e>"u")return;let r,o;if(typeof e!="object"&&(e=[e]),Q(e))for(r=0,o=e.length;r<o;r++)t.call(null,e[r],r,e);else{const s=n?Object.getOwnPropertyNames(e):Object.keys(e),i=s.length;let a;for(r=0;r<i;r++)a=s[r],t.call(null,e[a],a,e)}}function Pt(e,t){t=t.toLowerCase();const n=Object.keys(e);let r=n.length,o;for(;r-- >0;)if(o=n[r],t===o.toLowerCase())return o;return null}const Wt=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),xt=e=>!ne(e)&&e!==Wt;function Re(){const{caseless:e}=xt(this)&&this||{},t={},n=(r,o)=>{const s=e&&Pt(t,o)||o;ae(t[s])&&ae(r)?t[s]=Re(t[s],r):ae(r)?t[s]=Re({},r):Q(r)?t[s]=r.slice():t[s]=r};for(let r=0,o=arguments.length;r<o;r++)arguments[r]&&se(arguments[r],n);return t}const In=(e,t,n,{allOwnKeys:r}={})=>(se(t,(o,s)=>{n&&R(o)?e[s]=vt(o,n):e[s]=o},{allOwnKeys:r}),e),Vn=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),Hn=(e,t,n,r)=>{e.prototype=Object.create(t.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},qn=(e,t,n,r)=>{let o,s,i;const a={};if(t=t||{},e==null)return t;do{for(o=Object.getOwnPropertyNames(e),s=o.length;s-- >0;)i=o[s],(!r||r(i,e,t))&&!a[i]&&(t[i]=e[i],a[i]=!0);e=n!==!1&&_e(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},$n=(e,t,n)=>{e=String(e),(n===void 0||n>e.length)&&(n=e.length),n-=t.length;const r=e.indexOf(t,n);return r!==-1&&r===n},zn=e=>{if(!e)return null;if(Q(e))return e;let t=e.length;if(!Tt(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},Gn=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&_e(Uint8Array)),Jn=(e,t)=>{const r=(e&&e[Symbol.iterator]).call(e);let o;for(;(o=r.next())&&!o.done;){const s=o.value;t.call(e,s[0],s[1])}},Kn=(e,t)=>{let n;const r=[];for(;(n=e.exec(t))!==null;)r.push(n);return r},Yn=L("HTMLFormElement"),Xn=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,r,o){return r.toUpperCase()+o}),tt=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),Qn=L("RegExp"),Rt=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),r={};se(n,(o,s)=>{let i;(i=t(o,s,e))!==!1&&(r[s]=i||o)}),Object.defineProperties(e,r)},Zn=e=>{Rt(e,(t,n)=>{if(R(e)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const r=e[n];if(R(r)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},er=(e,t)=>{const n={},r=o=>{o.forEach(s=>{n[s]=!0})};return Q(e)?r(e):r(String(e).split(t)),n},tr=()=>{},nr=(e,t)=>(e=+e,Number.isFinite(e)?e:t),Ee="abcdefghijklmnopqrstuvwxyz",nt="0123456789",Ct={DIGIT:nt,ALPHA:Ee,ALPHA_DIGIT:Ee+Ee.toUpperCase()+nt},rr=(e=16,t=Ct.ALPHA_DIGIT)=>{let n="";const{length:r}=t;for(;e--;)n+=t[Math.random()*r|0];return n};function or(e){return!!(e&&R(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])}const sr=e=>{const t=new Array(10),n=(r,o)=>{if(me(r)){if(t.indexOf(r)>=0)return;if(!("toJSON"in r)){t[o]=r;const s=Q(r)?[]:{};return se(r,(i,a)=>{const u=n(i,o+1);!ne(u)&&(s[a]=u)}),t[o]=void 0,s}}return r};return n(e,0)},ir=L("AsyncFunction"),ar=e=>e&&(me(e)||R(e))&&R(e.then)&&R(e.catch),c={isArray:Q,isArrayBuffer:Et,isBuffer:Cn,isFormData:Un,isArrayBufferView:On,isString:kn,isNumber:Tt,isBoolean:Ln,isObject:me,isPlainObject:ae,isUndefined:ne,isDate:Nn,isFile:Bn,isBlob:Mn,isRegExp:Qn,isFunction:R,isStream:_n,isURLSearchParams:jn,isTypedArray:Gn,isFileList:Fn,forEach:se,merge:Re,extend:In,trim:Dn,stripBOM:Vn,inherits:Hn,toFlatObject:qn,kindOf:ye,kindOfTest:L,endsWith:$n,toArray:zn,forEachEntry:Jn,matchAll:Kn,isHTMLForm:Yn,hasOwnProperty:tt,hasOwnProp:tt,reduceDescriptors:Rt,freezeMethods:Zn,toObjectSet:er,toCamelCase:Xn,noop:tr,toFiniteNumber:nr,findKey:Pt,global:Wt,isContextDefined:xt,ALPHABET:Ct,generateString:rr,isSpecCompliantForm:or,toJSONObject:sr,isAsyncFn:ir,isThenable:ar};function g(e,t,n,r,o){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),r&&(this.request=r),o&&(this.response=o)}c.inherits(g,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:c.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const Ot=g.prototype,kt={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{kt[e]={value:e}});Object.defineProperties(g,kt);Object.defineProperty(Ot,"isAxiosError",{value:!0});g.from=(e,t,n,r,o,s)=>{const i=Object.create(Ot);return c.toFlatObject(e,i,function(u){return u!==Error.prototype},a=>a!=="isAxiosError"),g.call(i,e.message,t,n,r,o),i.cause=e,i.name=e.name,s&&Object.assign(i,s),i};const cr=null;function Ce(e){return c.isPlainObject(e)||c.isArray(e)}function Lt(e){return c.endsWith(e,"[]")?e.slice(0,-2):e}function rt(e,t,n){return e?e.concat(t).map(function(o,s){return o=Lt(o),!n&&s?"["+o+"]":o}).join(n?".":""):t}function lr(e){return c.isArray(e)&&!e.some(Ce)}const ur=c.toFlatObject(c,{},null,function(t){return/^is[A-Z]/.test(t)});function be(e,t,n){if(!c.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,n=c.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(p,b){return!c.isUndefined(b[p])});const r=n.metaTokens,o=n.visitor||f,s=n.dots,i=n.indexes,u=(n.Blob||typeof Blob<"u"&&Blob)&&c.isSpecCompliantForm(t);if(!c.isFunction(o))throw new TypeError("visitor must be a function");function d(h){if(h===null)return"";if(c.isDate(h))return h.toISOString();if(!u&&c.isBlob(h))throw new g("Blob is not supported. Use a Buffer instead.");return c.isArrayBuffer(h)||c.isTypedArray(h)?u&&typeof Blob=="function"?new Blob([h]):Buffer.from(h):h}function f(h,p,b){let y=h;if(h&&!b&&typeof h=="object"){if(c.endsWith(p,"{}"))p=r?p:p.slice(0,-2),h=JSON.stringify(h);else if(c.isArray(h)&&lr(h)||(c.isFileList(h)||c.endsWith(p,"[]"))&&(y=c.toArray(h)))return p=Lt(p),y.forEach(function(P,H){!(c.isUndefined(P)||P===null)&&t.append(i===!0?rt([p],H,s):i===null?p:p+"[]",d(P))}),!1}return Ce(h)?!0:(t.append(rt(b,p,s),d(h)),!1)}const l=[],m=Object.assign(ur,{defaultVisitor:f,convertValue:d,isVisitable:Ce});function v(h,p){if(!c.isUndefined(h)){if(l.indexOf(h)!==-1)throw Error("Circular reference detected in "+p.join("."));l.push(h),c.forEach(h,function(y,w){(!(c.isUndefined(y)||y===null)&&o.call(t,y,c.isString(w)?w.trim():w,p,m))===!0&&v(y,p?p.concat(w):[w])}),l.pop()}}if(!c.isObject(e))throw new TypeError("data must be an object");return v(e),t}function ot(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(r){return t[r]})}function Ue(e,t){this._pairs=[],e&&be(e,this,t)}const Nt=Ue.prototype;Nt.append=function(t,n){this._pairs.push([t,n])};Nt.toString=function(t){const n=t?function(r){return t.call(this,r,ot)}:ot;return this._pairs.map(function(o){return n(o[0])+"="+n(o[1])},"").join("&")};function fr(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Bt(e,t,n){if(!t)return e;const r=n&&n.encode||fr,o=n&&n.serialize;let s;if(o?s=o(t,n):s=c.isURLSearchParams(t)?t.toString():new Ue(t,n).toString(r),s){const i=e.indexOf("#");i!==-1&&(e=e.slice(0,i)),e+=(e.indexOf("?")===-1?"?":"&")+s}return e}class pr{constructor(){this.handlers=[]}use(t,n,r){return this.handlers.push({fulfilled:t,rejected:n,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){c.forEach(this.handlers,function(r){r!==null&&t(r)})}}const st=pr,Mt={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},dr=typeof URLSearchParams<"u"?URLSearchParams:Ue,hr=typeof FormData<"u"?FormData:null,yr=typeof Blob<"u"?Blob:null,gr={isBrowser:!0,classes:{URLSearchParams:dr,FormData:hr,Blob:yr},protocols:["http","https","file","blob","url","data"]},Ft=typeof window<"u"&&typeof document<"u",mr=(e=>Ft&&["ReactNative","NativeScript","NS"].indexOf(e)<0)(typeof navigator<"u"&&navigator.product),br=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),wr=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Ft,hasStandardBrowserEnv:mr,hasStandardBrowserWebWorkerEnv:br},Symbol.toStringTag,{value:"Module"})),k={...wr,...gr};function Ar(e,t){return be(e,new k.classes.URLSearchParams,Object.assign({visitor:function(n,r,o,s){return k.isNode&&c.isBuffer(n)?(this.append(r,n.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)}},t))}function Sr(e){return c.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function vr(e){const t={},n=Object.keys(e);let r;const o=n.length;let s;for(r=0;r<o;r++)s=n[r],t[s]=e[s];return t}function _t(e){function t(n,r,o,s){let i=n[s++];if(i==="__proto__")return!0;const a=Number.isFinite(+i),u=s>=n.length;return i=!i&&c.isArray(o)?o.length:i,u?(c.hasOwnProp(o,i)?o[i]=[o[i],r]:o[i]=r,!a):((!o[i]||!c.isObject(o[i]))&&(o[i]=[]),t(n,r,o[i],s)&&c.isArray(o[i])&&(o[i]=vr(o[i])),!a)}if(c.isFormData(e)&&c.isFunction(e.entries)){const n={};return c.forEachEntry(e,(r,o)=>{t(Sr(r),o,n,0)}),n}return null}function Er(e,t,n){if(c.isString(e))try{return(t||JSON.parse)(e),c.trim(e)}catch(r){if(r.name!=="SyntaxError")throw r}return(n||JSON.stringify)(e)}const je={transitional:Mt,adapter:["xhr","http"],transformRequest:[function(t,n){const r=n.getContentType()||"",o=r.indexOf("application/json")>-1,s=c.isObject(t);if(s&&c.isHTMLForm(t)&&(t=new FormData(t)),c.isFormData(t))return o?JSON.stringify(_t(t)):t;if(c.isArrayBuffer(t)||c.isBuffer(t)||c.isStream(t)||c.isFile(t)||c.isBlob(t))return t;if(c.isArrayBufferView(t))return t.buffer;if(c.isURLSearchParams(t))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let a;if(s){if(r.indexOf("application/x-www-form-urlencoded")>-1)return Ar(t,this.formSerializer).toString();if((a=c.isFileList(t))||r.indexOf("multipart/form-data")>-1){const u=this.env&&this.env.FormData;return be(a?{"files[]":t}:t,u&&new u,this.formSerializer)}}return s||o?(n.setContentType("application/json",!1),Er(t)):t}],transformResponse:[function(t){const n=this.transitional||je.transitional,r=n&&n.forcedJSONParsing,o=this.responseType==="json";if(t&&c.isString(t)&&(r&&!this.responseType||o)){const i=!(n&&n.silentJSONParsing)&&o;try{return JSON.parse(t)}catch(a){if(i)throw a.name==="SyntaxError"?g.from(a,g.ERR_BAD_RESPONSE,this,null,this.response):a}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:k.classes.FormData,Blob:k.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};c.forEach(["delete","get","head","post","put","patch"],e=>{je.headers[e]={}});const De=je,Tr=c.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Pr=e=>{const t={};let n,r,o;return e&&e.split(`
`).forEach(function(i){o=i.indexOf(":"),n=i.substring(0,o).trim().toLowerCase(),r=i.substring(o+1).trim(),!(!n||t[n]&&Tr[n])&&(n==="set-cookie"?t[n]?t[n].push(r):t[n]=[r]:t[n]=t[n]?t[n]+", "+r:r)}),t},it=Symbol("internals");function Z(e){return e&&String(e).trim().toLowerCase()}function ce(e){return e===!1||e==null?e:c.isArray(e)?e.map(ce):String(e)}function Wr(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(e);)t[r[1]]=r[2];return t}const xr=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function Te(e,t,n,r,o){if(c.isFunction(r))return r.call(this,t,n);if(o&&(t=n),!!c.isString(t)){if(c.isString(r))return t.indexOf(r)!==-1;if(c.isRegExp(r))return r.test(t)}}function Rr(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,n,r)=>n.toUpperCase()+r)}function Cr(e,t){const n=c.toCamelCase(" "+t);["get","set","has"].forEach(r=>{Object.defineProperty(e,r+n,{value:function(o,s,i){return this[r].call(this,t,o,s,i)},configurable:!0})})}class we{constructor(t){t&&this.set(t)}set(t,n,r){const o=this;function s(a,u,d){const f=Z(u);if(!f)throw new Error("header name must be a non-empty string");const l=c.findKey(o,f);(!l||o[l]===void 0||d===!0||d===void 0&&o[l]!==!1)&&(o[l||u]=ce(a))}const i=(a,u)=>c.forEach(a,(d,f)=>s(d,f,u));return c.isPlainObject(t)||t instanceof this.constructor?i(t,n):c.isString(t)&&(t=t.trim())&&!xr(t)?i(Pr(t),n):t!=null&&s(n,t,r),this}get(t,n){if(t=Z(t),t){const r=c.findKey(this,t);if(r){const o=this[r];if(!n)return o;if(n===!0)return Wr(o);if(c.isFunction(n))return n.call(this,o,r);if(c.isRegExp(n))return n.exec(o);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,n){if(t=Z(t),t){const r=c.findKey(this,t);return!!(r&&this[r]!==void 0&&(!n||Te(this,this[r],r,n)))}return!1}delete(t,n){const r=this;let o=!1;function s(i){if(i=Z(i),i){const a=c.findKey(r,i);a&&(!n||Te(r,r[a],a,n))&&(delete r[a],o=!0)}}return c.isArray(t)?t.forEach(s):s(t),o}clear(t){const n=Object.keys(this);let r=n.length,o=!1;for(;r--;){const s=n[r];(!t||Te(this,this[s],s,t,!0))&&(delete this[s],o=!0)}return o}normalize(t){const n=this,r={};return c.forEach(this,(o,s)=>{const i=c.findKey(r,s);if(i){n[i]=ce(o),delete n[s];return}const a=t?Rr(s):String(s).trim();a!==s&&delete n[s],n[a]=ce(o),r[a]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const n=Object.create(null);return c.forEach(this,(r,o)=>{r!=null&&r!==!1&&(n[o]=t&&c.isArray(r)?r.join(", "):r)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,n])=>t+": "+n).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...n){const r=new this(t);return n.forEach(o=>r.set(o)),r}static accessor(t){const r=(this[it]=this[it]={accessors:{}}).accessors,o=this.prototype;function s(i){const a=Z(i);r[a]||(Cr(o,i),r[a]=!0)}return c.isArray(t)?t.forEach(s):s(t),this}}we.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);c.reduceDescriptors(we.prototype,({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(r){this[n]=r}}});c.freezeMethods(we);const M=we;function Pe(e,t){const n=this||De,r=t||n,o=M.from(r.headers);let s=r.data;return c.forEach(e,function(a){s=a.call(n,s,o.normalize(),t?t.status:void 0)}),o.normalize(),s}function Ut(e){return!!(e&&e.__CANCEL__)}function ie(e,t,n){g.call(this,e??"canceled",g.ERR_CANCELED,t,n),this.name="CanceledError"}c.inherits(ie,g,{__CANCEL__:!0});function Or(e,t,n){const r=n.config.validateStatus;!n.status||!r||r(n.status)?e(n):t(new g("Request failed with status code "+n.status,[g.ERR_BAD_REQUEST,g.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}const kr=k.hasStandardBrowserEnv?{write(e,t,n,r,o,s){const i=[e+"="+encodeURIComponent(t)];c.isNumber(n)&&i.push("expires="+new Date(n).toGMTString()),c.isString(r)&&i.push("path="+r),c.isString(o)&&i.push("domain="+o),s===!0&&i.push("secure"),document.cookie=i.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Lr(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function Nr(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function jt(e,t){return e&&!Lr(t)?Nr(e,t):t}const Br=k.hasStandardBrowserEnv?function(){const t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");let r;function o(s){let i=s;return t&&(n.setAttribute("href",i),i=n.href),n.setAttribute("href",i),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:n.pathname.charAt(0)==="/"?n.pathname:"/"+n.pathname}}return r=o(window.location.href),function(i){const a=c.isString(i)?o(i):i;return a.protocol===r.protocol&&a.host===r.host}}():function(){return function(){return!0}}();function Mr(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function Fr(e,t){e=e||10;const n=new Array(e),r=new Array(e);let o=0,s=0,i;return t=t!==void 0?t:1e3,function(u){const d=Date.now(),f=r[s];i||(i=d),n[o]=u,r[o]=d;let l=s,m=0;for(;l!==o;)m+=n[l++],l=l%e;if(o=(o+1)%e,o===s&&(s=(s+1)%e),d-i<t)return;const v=f&&d-f;return v?Math.round(m*1e3/v):void 0}}function at(e,t){let n=0;const r=Fr(50,250);return o=>{const s=o.loaded,i=o.lengthComputable?o.total:void 0,a=s-n,u=r(a),d=s<=i;n=s;const f={loaded:s,total:i,progress:i?s/i:void 0,bytes:a,rate:u||void 0,estimated:u&&i&&d?(i-s)/u:void 0,event:o};f[t?"download":"upload"]=!0,e(f)}}const _r=typeof XMLHttpRequest<"u",Ur=_r&&function(e){return new Promise(function(n,r){let o=e.data;const s=M.from(e.headers).normalize();let{responseType:i,withXSRFToken:a}=e,u;function d(){e.cancelToken&&e.cancelToken.unsubscribe(u),e.signal&&e.signal.removeEventListener("abort",u)}let f;if(c.isFormData(o)){if(k.hasStandardBrowserEnv||k.hasStandardBrowserWebWorkerEnv)s.setContentType(!1);else if((f=s.getContentType())!==!1){const[p,...b]=f?f.split(";").map(y=>y.trim()).filter(Boolean):[];s.setContentType([p||"multipart/form-data",...b].join("; "))}}let l=new XMLHttpRequest;if(e.auth){const p=e.auth.username||"",b=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";s.set("Authorization","Basic "+btoa(p+":"+b))}const m=jt(e.baseURL,e.url);l.open(e.method.toUpperCase(),Bt(m,e.params,e.paramsSerializer),!0),l.timeout=e.timeout;function v(){if(!l)return;const p=M.from("getAllResponseHeaders"in l&&l.getAllResponseHeaders()),y={data:!i||i==="text"||i==="json"?l.responseText:l.response,status:l.status,statusText:l.statusText,headers:p,config:e,request:l};Or(function(P){n(P),d()},function(P){r(P),d()},y),l=null}if("onloadend"in l?l.onloadend=v:l.onreadystatechange=function(){!l||l.readyState!==4||l.status===0&&!(l.responseURL&&l.responseURL.indexOf("file:")===0)||setTimeout(v)},l.onabort=function(){l&&(r(new g("Request aborted",g.ECONNABORTED,e,l)),l=null)},l.onerror=function(){r(new g("Network Error",g.ERR_NETWORK,e,l)),l=null},l.ontimeout=function(){let b=e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded";const y=e.transitional||Mt;e.timeoutErrorMessage&&(b=e.timeoutErrorMessage),r(new g(b,y.clarifyTimeoutError?g.ETIMEDOUT:g.ECONNABORTED,e,l)),l=null},k.hasStandardBrowserEnv&&(a&&c.isFunction(a)&&(a=a(e)),a||a!==!1&&Br(m))){const p=e.xsrfHeaderName&&e.xsrfCookieName&&kr.read(e.xsrfCookieName);p&&s.set(e.xsrfHeaderName,p)}o===void 0&&s.setContentType(null),"setRequestHeader"in l&&c.forEach(s.toJSON(),function(b,y){l.setRequestHeader(y,b)}),c.isUndefined(e.withCredentials)||(l.withCredentials=!!e.withCredentials),i&&i!=="json"&&(l.responseType=e.responseType),typeof e.onDownloadProgress=="function"&&l.addEventListener("progress",at(e.onDownloadProgress,!0)),typeof e.onUploadProgress=="function"&&l.upload&&l.upload.addEventListener("progress",at(e.onUploadProgress)),(e.cancelToken||e.signal)&&(u=p=>{l&&(r(!p||p.type?new ie(null,e,l):p),l.abort(),l=null)},e.cancelToken&&e.cancelToken.subscribe(u),e.signal&&(e.signal.aborted?u():e.signal.addEventListener("abort",u)));const h=Mr(m);if(h&&k.protocols.indexOf(h)===-1){r(new g("Unsupported protocol "+h+":",g.ERR_BAD_REQUEST,e));return}l.send(o||null)})},Oe={http:cr,xhr:Ur};c.forEach(Oe,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const ct=e=>`- ${e}`,jr=e=>c.isFunction(e)||e===null||e===!1,Dt={getAdapter:e=>{e=c.isArray(e)?e:[e];const{length:t}=e;let n,r;const o={};for(let s=0;s<t;s++){n=e[s];let i;if(r=n,!jr(n)&&(r=Oe[(i=String(n)).toLowerCase()],r===void 0))throw new g(`Unknown adapter '${i}'`);if(r)break;o[i||"#"+s]=r}if(!r){const s=Object.entries(o).map(([a,u])=>`adapter ${a} `+(u===!1?"is not supported by the environment":"is not available in the build"));let i=t?s.length>1?`since :
`+s.map(ct).join(`
`):" "+ct(s[0]):"as no adapter specified";throw new g("There is no suitable adapter to dispatch the request "+i,"ERR_NOT_SUPPORT")}return r},adapters:Oe};function We(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new ie(null,e)}function lt(e){return We(e),e.headers=M.from(e.headers),e.data=Pe.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),Dt.getAdapter(e.adapter||De.adapter)(e).then(function(r){return We(e),r.data=Pe.call(e,e.transformResponse,r),r.headers=M.from(r.headers),r},function(r){return Ut(r)||(We(e),r&&r.response&&(r.response.data=Pe.call(e,e.transformResponse,r.response),r.response.headers=M.from(r.response.headers))),Promise.reject(r)})}const ut=e=>e instanceof M?{...e}:e;function Y(e,t){t=t||{};const n={};function r(d,f,l){return c.isPlainObject(d)&&c.isPlainObject(f)?c.merge.call({caseless:l},d,f):c.isPlainObject(f)?c.merge({},f):c.isArray(f)?f.slice():f}function o(d,f,l){if(c.isUndefined(f)){if(!c.isUndefined(d))return r(void 0,d,l)}else return r(d,f,l)}function s(d,f){if(!c.isUndefined(f))return r(void 0,f)}function i(d,f){if(c.isUndefined(f)){if(!c.isUndefined(d))return r(void 0,d)}else return r(void 0,f)}function a(d,f,l){if(l in t)return r(d,f);if(l in e)return r(void 0,d)}const u={url:s,method:s,data:s,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,withXSRFToken:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:a,headers:(d,f)=>o(ut(d),ut(f),!0)};return c.forEach(Object.keys(Object.assign({},e,t)),function(f){const l=u[f]||o,m=l(e[f],t[f],f);c.isUndefined(m)&&l!==a||(n[f]=m)}),n}const It="1.6.8",Ie={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Ie[e]=function(r){return typeof r===e||"a"+(t<1?"n ":" ")+e}});const ft={};Ie.transitional=function(t,n,r){function o(s,i){return"[Axios v"+It+"] Transitional option '"+s+"'"+i+(r?". "+r:"")}return(s,i,a)=>{if(t===!1)throw new g(o(i," has been removed"+(n?" in "+n:"")),g.ERR_DEPRECATED);return n&&!ft[i]&&(ft[i]=!0,console.warn(o(i," has been deprecated since v"+n+" and will be removed in the near future"))),t?t(s,i,a):!0}};function Dr(e,t,n){if(typeof e!="object")throw new g("options must be an object",g.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let o=r.length;for(;o-- >0;){const s=r[o],i=t[s];if(i){const a=e[s],u=a===void 0||i(a,s,e);if(u!==!0)throw new g("option "+s+" must be "+u,g.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new g("Unknown option "+s,g.ERR_BAD_OPTION)}}const ke={assertOptions:Dr,validators:Ie},_=ke.validators;class fe{constructor(t){this.defaults=t,this.interceptors={request:new st,response:new st}}async request(t,n){try{return await this._request(t,n)}catch(r){if(r instanceof Error){let o;Error.captureStackTrace?Error.captureStackTrace(o={}):o=new Error;const s=o.stack?o.stack.replace(/^.+\n/,""):"";r.stack?s&&!String(r.stack).endsWith(s.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+s):r.stack=s}throw r}}_request(t,n){typeof t=="string"?(n=n||{},n.url=t):n=t||{},n=Y(this.defaults,n);const{transitional:r,paramsSerializer:o,headers:s}=n;r!==void 0&&ke.assertOptions(r,{silentJSONParsing:_.transitional(_.boolean),forcedJSONParsing:_.transitional(_.boolean),clarifyTimeoutError:_.transitional(_.boolean)},!1),o!=null&&(c.isFunction(o)?n.paramsSerializer={serialize:o}:ke.assertOptions(o,{encode:_.function,serialize:_.function},!0)),n.method=(n.method||this.defaults.method||"get").toLowerCase();let i=s&&c.merge(s.common,s[n.method]);s&&c.forEach(["delete","get","head","post","put","patch","common"],h=>{delete s[h]}),n.headers=M.concat(i,s);const a=[];let u=!0;this.interceptors.request.forEach(function(p){typeof p.runWhen=="function"&&p.runWhen(n)===!1||(u=u&&p.synchronous,a.unshift(p.fulfilled,p.rejected))});const d=[];this.interceptors.response.forEach(function(p){d.push(p.fulfilled,p.rejected)});let f,l=0,m;if(!u){const h=[lt.bind(this),void 0];for(h.unshift.apply(h,a),h.push.apply(h,d),m=h.length,f=Promise.resolve(n);l<m;)f=f.then(h[l++],h[l++]);return f}m=a.length;let v=n;for(l=0;l<m;){const h=a[l++],p=a[l++];try{v=h(v)}catch(b){p.call(this,b);break}}try{f=lt.call(this,v)}catch(h){return Promise.reject(h)}for(l=0,m=d.length;l<m;)f=f.then(d[l++],d[l++]);return f}getUri(t){t=Y(this.defaults,t);const n=jt(t.baseURL,t.url);return Bt(n,t.params,t.paramsSerializer)}}c.forEach(["delete","get","head","options"],function(t){fe.prototype[t]=function(n,r){return this.request(Y(r||{},{method:t,url:n,data:(r||{}).data}))}});c.forEach(["post","put","patch"],function(t){function n(r){return function(s,i,a){return this.request(Y(a||{},{method:t,headers:r?{"Content-Type":"multipart/form-data"}:{},url:s,data:i}))}}fe.prototype[t]=n(),fe.prototype[t+"Form"]=n(!0)});const le=fe;class Ve{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(s){n=s});const r=this;this.promise.then(o=>{if(!r._listeners)return;let s=r._listeners.length;for(;s-- >0;)r._listeners[s](o);r._listeners=null}),this.promise.then=o=>{let s;const i=new Promise(a=>{r.subscribe(a),s=a}).then(o);return i.cancel=function(){r.unsubscribe(s)},i},t(function(s,i,a){r.reason||(r.reason=new ie(s,i,a),n(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const n=this._listeners.indexOf(t);n!==-1&&this._listeners.splice(n,1)}static source(){let t;return{token:new Ve(function(o){t=o}),cancel:t}}}const Ir=Ve;function Vr(e){return function(n){return e.apply(null,n)}}function Hr(e){return c.isObject(e)&&e.isAxiosError===!0}const Le={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Le).forEach(([e,t])=>{Le[t]=e});const qr=Le;function Vt(e){const t=new le(e),n=vt(le.prototype.request,t);return c.extend(n,le.prototype,t,{allOwnKeys:!0}),c.extend(n,t,null,{allOwnKeys:!0}),n.create=function(o){return Vt(Y(e,o))},n}const S=Vt(De);S.Axios=le;S.CanceledError=ie;S.CancelToken=Ir;S.isCancel=Ut;S.VERSION=It;S.toFormData=be;S.AxiosError=g;S.Cancel=S.CanceledError;S.all=function(t){return Promise.all(t)};S.spread=Vr;S.isAxiosError=Hr;S.mergeConfig=Y;S.AxiosHeaders=M;S.formToJSON=e=>_t(c.isHTMLForm(e)?new FormData(e):e);S.getAdapter=Dt.getAdapter;S.HttpStatusCode=qr;S.default=S;const Ht=S,ee=Ht.create({baseURL:"https://polyglot-api-staging.polyglot-edu.com",headers:{"Content-Type":"application/json"}}),pt=Ht.create({baseURL:"https://papygame.tech/api/v1",headers:{"Content-Type":"application/json"}}),pe={getLPList:()=>ee.get("/api/flows/"),getActualNode:e=>ee.post("/api/execution/actual",e),getFirstNode:e=>ee.post("/api/execution/first",e),getNextNode:e=>ee.post("/api/execution/next",e),loadFlowList:e=>{const t=e?"?q="+e:"";return ee.get("/api/flows"+t)},createAssigmentPapyrus:e=>pt.post("/newBlankProject",e),userPapyPoints:e=>pt.get("/graderResults?project_id="+e)};let He="https://admin.workadventu.re";function qe(){const e=WA.player.userRoomToken;if(e===void 0)throw new Error("No userRoomToken found. The quests plugin can only work with WorkAdventure SAAS edition (at https://play.workadventu.re).");return e}async function $r(e){const t=new URL(`/api/quests/${e}`,He);t.search=new URLSearchParams({room:WA.room.id}).toString();const n=await fetch(t,{method:"GET",headers:{Authorization:qe()}});if(!n.ok)throw new Error(`An error occurred. HTTP Code: ${n.status} ${n.statusText}.`);return await n.json()}async function q(e,t){if(!WA.player.isLogged)throw new Error("You must be logged to gain XP.");const n=new URL(`/api/quests/${e}/level-up`,He),r=await fetch(n,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:qe()},body:JSON.stringify({xp:t})});if(!r.ok)throw new Error(`An error occurred. HTTP Code: ${r.status} ${r.statusText}.`);const o=await r.json();return o.awardedBadges.length>0&&(async()=>{for(const s of o.awardedBadges)await zr(e,s)})().catch(s=>{console.error(s)}),o}async function zr(e,t){const n=new URL(`/quests/${e}/badge/${t}/congratulations`,He);n.search=new URLSearchParams({token:qe()}).toString(),await WA.ui.website.open({url:n.toString(),position:{vertical:"middle",horizontal:"middle"},allowApi:!0,visible:!0,size:{width:"100%",height:"100%"}})}const ue=[{key:"keyLP",cases:["learningPath"],generalPoints:100},{key:"codingKey",cases:["VSCode"],generalPoints:100},{key:"collaborativeKey",cases:["Eraser"],generalPoints:100},{key:"demo2024event",cases:["PapyrusWeb"],generalPoints:100},{key:"knowledgeKey",cases:["WebApp"],generalPoints:100},{key:"generalKey",cases:[],generalPoints:100}];console.log("Script started successfully");let W,A,$,C,z,G,V=[{x:0,y:0}],de,dt,O;function B(){C!==void 0&&(C.close(),C=void 0)}function I(){$!==void 0&&($.close(),$=void 0)}function F(){z!==void 0&&(z.close(),z=void 0)}function j(){G!==void 0&&(G.close(),G=void 0)}function ht(e,t){F(),z=WA.ui.openPopup(e,"Wrong area, here you are able to make activity connected to "+t,[{label:"Close",className:"normal",callback:()=>{F()}}]),setTimeout(function(){F()},3e3)}async function he(){const e=await WA.player.getPosition();console.log(e.y);const t=e.y>300?"bannerNarrative2":"bannerNarrative1";let n=`The city of Technopolis is falling apart. Its digital infrastructure, once the envy of the world, is now in chaos due to a centuries-old, corrupted system architecture. As an appointed Architect of Code, your task is to restore stability. But this mission is not yours alonethere are others, racing against you to solve Technopolis' problems and earn the title of Grand Architect. 
You'll traverse a sprawling digital city using a 2D map to navigate through different rooms where critical missions await. Every room contains learning challenges related to UML Modeling and in particular Class diagrams. Along the way, you'll collect points, badges, and level up, but only the top three learners will appear on the final Leaderboard, earning the ultimate rewards.`;A&&(n=A.description),O=WA.ui.displayActionMessage({message:"press 'space' or click here to open the narrative",callback:async()=>{j(),G=WA.ui.openPopup(t,n,[{label:"Close",className:"normal",callback:()=>{he(),O.remove(),j()}}]),setTimeout(function(){j(),he(),O.remove()},8e3)}})}const Gr=[{platform:["VSCode"],activityType:4,pos:{x:12,y:6}},{platform:["WebApp"],activityType:1,pos:{x:25,y:5}},{platform:["Eraser","PapyrusWeb"],activityType:3,pos:{x:17,y:4}}];let E={x:0,y:0};async function U(e){let t="";A&&(t=A.platform),await $e(t),F(),z=WA.ui.openPopup(e,'Your next activity is in "'+A.platform+'", go to the correct area.',[{label:"Close",className:"normal",callback:()=>{F()}}]),setTimeout(function(){F()},3e3),Gr.map(i=>{i.platform.includes(A.platform)&&(E={x:i.pos.x,y:i.pos.y+2}),WA.room.setTiles([{x:i.pos.x,y:i.pos.y,tile:i.platform.includes(A.platform)?"arrowBase":null,layer:"activity/Type5"}])});let n=await WA.player.getPosition(),r;do r=V.pop(),r&&WA.room.setTiles([{x:r.x,y:r.y,tile:null,layer:"activity/Type5"}]);while(r);n={x:Math.floor(n.x/33),y:Math.floor(n.y/33)};let o=0,s;if(E.x!=0)do if(o++,s=!(Math.abs(n.y-E.y)<3&&Math.abs(n.x-E.x)<3),Math.abs(n.y-E.y)>1){const i=n.x,a=n.y+(n.y<E.y?2:-2);WA.room.setTiles([{x:i,y:a,tile:"pointerBase",layer:"activity/Type5"}]),V.push({x:i,y:a}),n={x:i,y:a}}else if(Math.abs(n.x-E.x)>1){const i=n.x+(n.x<E.x?2:-2),a=n.y;WA.room.setTiles([{x:i,y:a,tile:"pointerBase",layer:"activity/Type5"}]),V.push({x:i,y:a}),n={x:i,y:a}}while(s&&o<20)}WA.player.onPlayerMove(async()=>{if(E.x==0)return;let e;do e=V.pop(),e&&WA.room.setTiles([{x:e.x,y:e.y,tile:null,layer:"activity/Type5"}]);while(e);let t=await WA.player.getPosition();t={x:Math.floor(t.x/33),y:Math.floor(t.y/33)};let n=0,r;if(E.x!=0)do if(n++,r=!(Math.abs(t.y-E.y)<3&&Math.abs(t.x-E.x)<3),Math.abs(t.y-E.y)>1){const o=t.x,s=t.y+(t.y<E.y?2:-2);WA.room.setTiles([{x:o,y:s,tile:"pointerBase",layer:"activity/Type5"}]),V.push({x:o,y:s}),t={x:o,y:s}}else if(Math.abs(t.x-E.x)>1){const o=t.x+(t.x<E.x?2:-2),s=t.y;WA.room.setTiles([{x:o,y:s,tile:"pointerBase",layer:"activity/Type5"}]),V.push({x:o,y:s}),t={x:o,y:s}}while(r&&n<20)});async function $e(e){try{if(console.log("getActual"),!W)throw"No ctx detected";await pe.getActualNode({ctxId:W}).then(async t=>{var n;if(console.log(t.data.platform),A&&t.data.platform!=A.platform)if(A.platform=="PapyrusWeb"&&de){const r=(await pe.userPapyPoints(de)).data;console.log(r.Grade);const o=r.Grade.indexOf(" out"),s=parseInt(r.Grade.substring(0,o));console.log(s),await q("UMLKey",s*10).then(async i=>{var a;i.awardedBadges!=null&&await q("generalKey",((a=ue.find(u=>u.key=="UMLKey"))==null?void 0:a.generalPoints)??0)}).catch(i=>console.log(i))}else{try{await q(((n=ue.find(r=>r.cases.includes(A.platform)))==null?void 0:n.key)??"",50).then(async r=>{var o;r.awardedBadges!=null&&await q("generalKey",((o=ue.find(s=>s.cases.includes(A.platform)))==null?void 0:o.generalPoints)??0)}).catch(r=>console.log(r))}catch(r){console.log(r)}console.log("platform point given")}A=t.data,console.log(A.validation),!A.validation[0]&&e==A.platform&&(console.log("LP point given"),await q("keyLP",100).catch(r=>console.log(r)),WA.player.state.actualFlow="",W=void 0)}).catch(async t=>{if(console.log(t),t.response.status&&t.response.status==400){console.log("ctx reset"),console.log(String(WA.player.state.actualFlow)),await qt(String(WA.player.state.actualFlow)).then(async()=>{console.log("new activity correctly"),await $e("reset")});return}throw console.error("Error:",t.response.status,t.response.statusText),new Error(`HTTP error! Status: ${t.response.status}`)})}catch(t){throw console.error("Error:",t),t}}async function qt(e){try{const t=WA.player.name,n=await pe.getFirstNode({flowId:e,username:t});if(console.log(e),n.status!=200)throw console.error("Error:",n.status,n.statusText),new Error(`HTTP error! Status: ${n.status}`);W=n.data.ctx;let r=WA.player.state.flows;r!=null?r.find(o=>o!=null?e==o.flowId:!1)?r.find(o=>o?e==o.flowId:!1).ctx=W:r[r.length+1]={flowId:e,ctx:W}:r=[{flowId:e,ctx:W}],WA.player.state.flows=r,console.log("starting activity done");return}catch(t){throw console.error("Error:",t),t}}WA.onInit().then(async()=>{console.log("Scripting API ready"),WA.room.website.create({name:"logo",url:"./images/solo_logo_32.png",position:{x:240,y:496,width:64,height:64},visible:!0,origin:"map",scale:1}),WA.room.website.create({name:"scritta",url:"./images/solo_scritta_32.png",position:{x:368,y:496,width:418,height:64},visible:!0,origin:"map",scale:1}),he(),WA.room.area.onLeave("Outside").subscribe(async()=>{E={x:0,y:0};let e;do e=V.pop(),e&&WA.room.setTiles([{x:e.x,y:e.y,tile:null,layer:"activity/Type5"}]);while(e)}),WA.room.area.onEnter("Entry").subscribe(async()=>{try{if(j(),!WA.player.state.actualFlow){G=WA.ui.openPopup("instructions","You have not selected a Learning Path, please go to the menu area to choose a path.",[{label:"Close",className:"normal",callback:()=>{j()}}]),setTimeout(function(){j()},3e3);return}console.log(WA.player.state.actualFlow);const e=WA.player.state.flows;if(e!=null&&e.find(t=>(t==null?void 0:t.flowId)==WA.player.state.actualFlow)!=null){W=e.find(t=>(t==null?void 0:t.flowId)==WA.player.state.actualFlow).ctx,console.log("ctx already created, continue activity"),U("instructions");return}console.log("starting activity"),await qt(String(WA.player.state.actualFlow)),await $e("instruction"),U("instructions")}catch(e){console.error("Failed to get API response:",e)}}),WA.room.area.onEnter("FlowsMenu").subscribe(async()=>{try{console.log("testing FlowsMenu"),$=WA.ui.openPopup("MenuBanner","Here you can choose which learning path you want to do, access the console to see the possibilities",[{label:"Close",className:"normal",callback:()=>{I()}}]),setTimeout(function(){I()},3e3),C=await WA.nav.openCoWebSite("https://polyglot-webapp.polyglot-edu.com/flowMenu",!0,void 0,55)}catch{}}),WA.room.area.onLeave("FlowsMenu").subscribe(async()=>{B()}),WA.room.area.onEnter("activityManager").subscribe(async()=>{try{console.log("testing FlowsMenu"),$=WA.ui.openPopup("MenuBanner","Here you can choose which learning path you want to do, access the console to see the possibilities",[{label:"Close",className:"normal",callback:()=>{I()}}]),setTimeout(function(){I()},3e3),C=await WA.nav.openCoWebSite("https://staging.polyglot-edu.com/waEducator",!0,void 0,55)}catch{}}),WA.room.area.onLeave("activityManager").subscribe(async()=>{B()}),WA.room.area.onEnter("creativeArea").subscribe(async()=>{try{console.log("area Activity5"),z=WA.ui.openPopup("BannerA5","This area is creative area, here you can access the Learning Path editor to create your personal path",[{label:"Close",className:"normal",callback:()=>{F()}}]),setTimeout(function(){F()},3e3),C=await WA.nav.openCoWebSite("https://staging.polyglot-edu.com/flows",!0,void 0,55)}catch(e){console.error("Failed to get API response:",e)}}),WA.room.area.onLeave("creativeArea").subscribe(async()=>{U("BannerA5"),B()}),WA.room.area.onEnter("instructions").subscribe(()=>{try{if(O.remove(),!WA.player.state.actualFlow){O=WA.ui.displayActionMessage({message:"press 'space' or click here to open the instruction WebPage",callback:async()=>{G=WA.ui.openPopup("instructions","You have not selected a Learning Path, please go to the menu area to choose a path.",[{label:"Close",className:"normal",callback:()=>{j()}}]),setTimeout(function(){j()},3e3)}});return}O=WA.ui.displayActionMessage({message:"press 'space' or click here to open the instruction WebPage",callback:async()=>{C=await WA.nav.openCoWebSite("https://polyglot-webapp.polyglot-edu.com/flowShower/"+WA.player.state.actualFlow,!0,void 0,55)}})}catch(e){console.log(e)}}),WA.room.area.onLeave("instructions").subscribe(async()=>{O.remove(),he(),B()}),WA.player.state.onVariableChange("actualFlow").subscribe(()=>{B(),I(),$=WA.ui.openPopup("MenuBanner","Learning path chose correctly, enter the school zone to start ",[{label:"Close",className:"normal",callback:()=>{I()}}]),setTimeout(function(){I()},3e3),console.log("website closed")}),WA.player.state.onVariableChange("platform").subscribe(e=>{e!="WebApp"&&(B(),console.log("website closed"),U("BannerA1"))}),WA.room.area.onEnter("ActivityType1").subscribe(async()=>{try{if(console.log("testing ACTIVITYTYPE1"),A.platform!="WebApp"){console.log("wrong spot, go to another area"),ht("BannerA1","WebApp");return}const e="https://polyglot-webapp.polyglot-edu.com/tools/"+W;C=await WA.nav.openCoWebSite(e,!0),console.log(e)}catch{}}),WA.room.area.onLeave("ActivityType1").subscribe(async()=>{B(),U("BannerA1")}),WA.room.area.onEnter("ActivityType2").subscribe(async()=>{console.log("ctx:",W);try{console.log("testing ACTIVITYTYPE2")}catch(e){console.error("Failed to get API response:",e)}}),WA.room.area.onLeave("ActivityType2").subscribe(async()=>{U("BannerA2")}),WA.room.area.onEnter("ActivityType3").subscribe(async()=>{try{if(console.log("area Activity3"),A.platform=="PapyrusWeb"){const e=WA.ui.openPopup("BannerA3","Loading your assignment inside PapyrusWeb, wait a moment",[]);setTimeout(function(){e.close()},3e3),await pe.createAssigmentPapyrus({ctxId:W||"",assignment_id:A.data.idUML,nomeUtente:WA.player.name}).then(async t=>{de=t.data.project_id,dt=t.data.representation_id,C=await WA.nav.openCoWebSite("https://papygame.tech/projects/"+de+"/edit/"+dt+"?ctxId="+W,!0)}).catch(async t=>{throw console.log(t),new Error(`HTTP error! Status: ${t.response.status}`)})}else A.platform=="Collaborative"&&(C=await WA.nav.openCoWebSite("https://app.eraser.io/workspace/JVoolrO5JJucnQkr1tK7?origin=share",!0))}catch(e){console.error("Failed to get API response:",e)}}),WA.room.area.onLeave("ActivityType3").subscribe(async()=>{U("BannerA3"),B()}),WA.room.area.onEnter("ActivityType4").subscribe(async()=>{try{if(A.platform!="VSCode"){ht("BannerA4","VSCode");return}F(),WA.ui.openPopup("BannerA4","Your next activity is coding assessment. Click Open Notebook to open the notebook directly on your VSCode Editor",[{label:"Open Notebook",className:"normal",callback:()=>{WA.nav.openTab("vscode://ms-dotnettools.dotnet-interactive-vscode/openNotebook?url=https://polyglot-api-staging.polyglot-edu.com/api/flows/"+W+"/run/notebook.dib"),console.log("aa")}},{label:"Close",className:"normal",callback:e=>{e.close()}}]),O=WA.ui.displayActionMessage({message:"press 'space' or click here to open the instruction WebPage",callback:async()=>{window.open("vscode://ms-dotnettools.dotnet-interactive-vscode/openNotebook?url=https://polyglot-api-staging.polyglot-edu.com/api/flows/"+W+"/run/notebook.dib","_blank")}})}catch(e){console.error("Failed to get API response:",e)}}),WA.room.area.onLeave("ActivityType4").subscribe(async()=>{U("BannerA4")}),WA.room.area.onEnter("cleaningArea").subscribe(()=>{try{O=WA.ui.displayActionMessage({message:"Attention, if you press 'space' or click here to clean your points",callback:async()=>{console.log("deleting point"),ue.map(async e=>{const t=await $r(e.key);console.log(t),t&&await q(e.key,-t.xp)}),console.log("Points removed from the player")}});return}catch(e){console.log(e)}}),WA.room.area.onLeave("cleaningArea").subscribe(async()=>{O.remove(),B()}),xn().then(()=>{console.log("Scripting API Extra ready")}).catch(e=>console.error(e))}).catch(e=>console.error(e));
